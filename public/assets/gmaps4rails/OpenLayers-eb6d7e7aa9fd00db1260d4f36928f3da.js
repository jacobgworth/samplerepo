/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright 2005-2006 MetaCarta, Inc., released under a modified BSD license.
  Please see http://svn.openlayers.org/trunk/openlayers/release-license.txt
  for the full text of the license.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used please see the
  OpenLayers SVN repository: <http://openlayers.org/>)

*/
/* Contains portions of Prototype.js:
 *
 * Prototype JavaScript framework, version 1.4.0
 *  (c) 2005 Sam Stephenson <sam@conio.net>
 *
 *  Prototype is freely distributable under the terms of an MIT-style license.
 *  For details, see the Prototype web site: http://prototype.conio.net/
 *
/*--------------------------------------------------------------------------*/
/**  
*  
*  Contains portions of Rico <http://openrico.org/>
* 
*  Copyright 2005 Sabre Airline Solutions  
*  
*  Licensed under the Apache License, Version 2.0 (the "License"); you
*  may not use this file except in compliance with the License. You
*  may obtain a copy of the License at
*  
*         http://www.apache.org/licenses/LICENSE-2.0  
*  
*  Unless required by applicable law or agreed to in writing, software
*  distributed under the License is distributed on an "AS IS" BASIS,
*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
*  implied. See the License for the specific language governing
*  permissions and limitations under the License. 
*
**/
_OPENLAYERS_SFL_=!0,OpenLayers=new Object,OpenLayers._scriptName=typeof _OPENLAYERS_SFL_=="undefined"?"lib/OpenLayers.js":"OpenLayers.js",OpenLayers._getScriptLocation=function(){var a="",b=OpenLayers._scriptName,c=document.getElementsByTagName("script");for(var d=0;d<c.length;d++){var e=c[d].getAttribute("src");if(e){var f=e.lastIndexOf(b);if(f>-1&&f+b.length==e.length){a=e.slice(0,-b.length);break}}}return a},typeof _OPENLAYERS_SFL_=="undefined"&&function(){var a=new Array("OpenLayers/BaseTypes.js","OpenLayers/Util.js","Rico/Corner.js","Rico/Color.js","OpenLayers/Ajax.js","OpenLayers/Events.js","OpenLayers/Map.js","OpenLayers/Layer.js","OpenLayers/Icon.js","OpenLayers/Marker.js","OpenLayers/Marker/Box.js","OpenLayers/Popup.js","OpenLayers/Tile.js","OpenLayers/Feature.js","OpenLayers/Feature/WFS.js","OpenLayers/Tile/Image.js","OpenLayers/Tile/WFS.js","OpenLayers/Layer/Image.js","OpenLayers/Layer/EventPane.js","OpenLayers/Layer/FixedZoomLevels.js","OpenLayers/Layer/Google.js","OpenLayers/Layer/VirtualEarth.js","OpenLayers/Layer/Yahoo.js","OpenLayers/Layer/HTTPRequest.js","OpenLayers/Layer/Grid.js","OpenLayers/Layer/MapServer.js","OpenLayers/Layer/KaMap.js","OpenLayers/Layer/MultiMap.js","OpenLayers/Layer/Markers.js","OpenLayers/Layer/Text.js","OpenLayers/Layer/WorldWind.js","OpenLayers/Layer/WMS.js","OpenLayers/Layer/WFS.js","OpenLayers/Layer/WMS/Untiled.js","OpenLayers/Layer/GeoRSS.js","OpenLayers/Layer/Boxes.js","OpenLayers/Layer/Canvas.js","OpenLayers/Popup/Anchored.js","OpenLayers/Popup/AnchoredBubble.js","OpenLayers/Control.js","OpenLayers/Control/MouseDefaults.js","OpenLayers/Control/MouseToolbar.js","OpenLayers/Control/MousePosition.js","OpenLayers/Control/OverviewMap.js","OpenLayers/Control/KeyboardDefaults.js","OpenLayers/Control/PanZoom.js","OpenLayers/Control/PanZoomBar.js","OpenLayers/Control/ArgParser.js","OpenLayers/Control/Permalink.js","OpenLayers/Control/Scale.js","OpenLayers/Control/LayerSwitcher.js"),b="",c=OpenLayers._getScriptLocation()+"lib/";for(var d=0;d<a.length;d++)if(/MSIE/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent)){var e="<script src='"+c+a[d]+"'></script>";b+=e}else{var f=document.createElement("script");f.src=c+a[d];var g=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;g.appendChild(f)}b&&document.write(b)}(),OpenLayers.VERSION_NUMBER="$Revision: 1865 $",OpenLayers.Class={isPrototype:function(){},create:function(){return function(){arguments&&arguments[0]!=OpenLayers.Class.isPrototype&&this.initialize.apply(this,arguments)}},inherit:function(){var a=arguments[0],b=new a(OpenLayers.Class.isPrototype);for(var c=1;c<arguments.length;c++){if(typeof arguments[c]=="function"){var d=arguments[c];arguments[c]=new d(OpenLayers.Class.isPrototype)}OpenLayers.Util.extend(b,arguments[c])}return b}},OpenLayers.Pixel=OpenLayers.Class.create(),OpenLayers.Pixel.prototype={x:0,y:0,initialize:function(a,b){this.x=parseFloat(a),this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;return a!=null&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y)),b},add:function(a,b){return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();return a&&(b=this.add(a.x,a.y)),b},CLASS_NAME:"OpenLayers.Pixel"},OpenLayers.Size=OpenLayers.Class.create(),OpenLayers.Size.prototype={w:0,h:0,initialize:function(a,b){this.w=parseFloat(a),this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;return a!=null&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h)),b},CLASS_NAME:"OpenLayers.Size"},OpenLayers.LonLat=OpenLayers.Class.create(),OpenLayers.LonLat.prototype={lon:0,lat:0,initialize:function(a,b){this.lon=parseFloat(a),this.lat=parseFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){return new OpenLayers.LonLat(this.lon+a,this.lat+b)},equals:function(a){var b=!1;return a!=null&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat)),b},CLASS_NAME:"OpenLayers.LonLat"},OpenLayers.LonLat.fromString=function(a){var b=a.split(",");return new OpenLayers.LonLat(parseFloat(b[0]),parseFloat(b[1]))},OpenLayers.Bounds=OpenLayers.Class.create(),OpenLayers.Bounds.prototype={left:0,bottom:0,right:0,top:0,initialize:function(a,b,c,d){this.left=parseFloat(a),this.bottom=parseFloat(b),this.right=parseFloat(c),this.top=parseFloat(d)},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;return a!=null&&(b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom),b},toString:function(){return"left-bottom=("+this.left+","+this.bottom+")"+" right-top=("+this.right+","+this.top+")"},toBBOX:function(a){a==null&&(a=6);var b=Math.pow(10,a),c=Math.round(this.left*b)/b+","+Math.round(this.bottom*b)/b+","+Math.round(this.right*b)/b+","+Math.round(this.top*b)/b;return c},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)},add:function(a,b){return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},containsLonLat:function(a,b){return this.contains(a.lon,a.lat,b)},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){c==null&&(c=!0);var d=!1;return c?d=a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:d=a>this.left&&a<this.right&&b>this.bottom&&b<this.top,d},intersectsBounds:function(a,b){b==null&&(b=!0);var c=a.bottom==this.bottom&&a.top==this.top?!0:a.bottom>this.bottom&&a.bottom<this.top||this.bottom>a.bottom&&this.bottom<a.top,d=a.bottom==this.bottom&&a.top==this.top?!0:a.top>this.bottom&&a.top<this.top||this.top>a.bottom&&this.top<a.top,e=a.right==this.right&&a.left==this.left?!0:a.right>this.left&&a.right<this.right||this.right>a.left&&this.right<a.right,f=a.right==this.right&&a.left==this.left?!0:a.left>this.left&&a.left<this.right||this.left>a.left&&this.left<a.right;return this.containsBounds(a,!0,b)||a.containsBounds(this,!0,b)||(d||c)&&(f||e)},containsBounds:function(a,b,c){b==null&&(b=!1),c==null&&(c=!0);var d,e,f,g;return c?(d=a.left>=this.left&&a.left<=this.right,e=a.top>=this.bottom&&a.top<=this.top,f=a.right>=this.left&&a.right<=this.right,g=a.bottom>=this.bottom&&a.bottom<=this.top):(d=a.left>this.left&&a.left<this.right,e=a.top>this.bottom&&a.top<this.top,f=a.right>this.left&&a.right<this.right,g=a.bottom>this.bottom&&a.bottom<this.top),b?(e||g)&&(d||f):e&&d&&g&&f},determineQuadrant:function(a){var b="",c=this.getCenterLonLat();return b+=a.lat<c.lat?"b":"t",b+=a.lon<c.lon?"l":"r",b},CLASS_NAME:"OpenLayers.Bounds"},OpenLayers.Bounds.fromString=function(a){var b=a.split(",");return OpenLayers.Bounds.fromArray(b)},OpenLayers.Bounds.fromArray=function(a){return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]))},OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(a){var b="";return b+=a.charAt(0)=="t"?"b":"t",b+=a.charAt(1)=="l"?"r":"l",b},OpenLayers.Element={visible:function(a){return $(a).style.display!="none"},toggle:function(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);OpenLayers.Element[OpenLayers.Element.visible(b)?"hide":"show"](b)}},hide:function(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);b.style.display="none"}},show:function(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);b.style.display=""}},remove:function(a){a=$(a),a.parentNode.removeChild(a)},getHeight:function(a){return a=$(a),a.offsetHeight},getDimensions:function(a){a=$(a);if(OpenLayers.Element.getStyle(a,"display")!="none")return{width:a.offsetWidth,height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position;b.visibility="hidden",b.position="absolute",b.display="";var e=a.clientWidth,f=a.clientHeight;return b.display="none",b.position=d,b.visibility=c,{width:e,height:f}},getStyle:function(a,b){a=$(a);var c=a.style[b.camelize()];if(!c)if(document.defaultView&&document.defaultView.getComputedStyle){var d=document.defaultView.getComputedStyle(a,null);c=d?d.getPropertyValue(b):null}else a.currentStyle&&(c=a.currentStyle[b.camelize()]);return window.opera&&OpenLayers.Util.indexOf(["left","top","right","bottom"],b)!=-1&&OpenLayers.Element.getStyle(a,"position")=="static"&&(c="auto"),c=="auto"?null:c}},String.prototype.startsWith=function(a){return this.substr(0,a.length)==a},String.prototype.contains=function(a){return this.indexOf(a)!=-1},String.prototype.trim=function(){var a=0;while(this.substr(a,1)==" ")a++;var b=this.length-1;while(this.substr(b,1)==" ")b--;return this.substring(a,b+1)},String.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1},String.prototype.camelize=function(){var a=this.split("-");if(a.length==1)return a[0];var b=this.indexOf("-")==0?a[0].charAt(0).toUpperCase()+a[0].substring(1):a[0];for(var c=1,d=a.length;c<d;c++){var e=a[c];b+=e.charAt(0).toUpperCase()+e.substring(1)}return b},Number.prototype.limitSigDigs=function(a){var b=a>0?this.toString():0;if(a<b.length){var c=b.length-a;b=Math.round(this/Math.pow(10,c))*Math.pow(10,c)}return parseInt(b)},Function.prototype.bind=function(){var a=this,b=[],c=arguments[0];for(var d=1;d<arguments.length;d++)b.push(arguments[d]);return function(d){for(var e=0;e<arguments.length;e++)b.push(arguments[e]);return a.apply(c,b)}},Function.prototype.bindAsEventListener=function(a){var b=this;return function(c){return b.call(a,c||window.event)}},OpenLayers.Util=new Object;if($==null)var $=function(){var a=new Array;for(var b=0;b<arguments.length;b++){var c=arguments[b];typeof c=="string"&&(c=document.getElementById(c));if(arguments.length==1)return c;a.push(c)}return a};OpenLayers.Util.extend=function(a,b){for(property in b)a[property]=b[property];return a},OpenLayers.Util.removeItem=function(a,b){for(var c=0;c<a.length;c++)a[c]==b&&a.splice(c,1);return a},OpenLayers.Util.clearArray=function(a){a.length=0},OpenLayers.Util.indexOf=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1},OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){b&&(a.id=b),c&&(a.style.left=c.x+"px",a.style.top=c.y+"px"),d&&(a.style.width=d.w+"px",a.style.height=d.h+"px"),e&&(a.style.position=e),f&&(a.style.border=f),g&&(a.style.overflow=g),h&&(a.style.opacity=h,a.style.filter="alpha(opacity="+h*100+")")},OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var i=document.createElement("div");return d&&(i.style.backgroundImage="url("+d+")"),a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv")),e||(e="absolute"),OpenLayers.Util.modifyDOMElement(i,a,b,c,e,f,g,h),i},OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){return image=document.createElement("img"),h&&(image.style.display="none",OpenLayers.Event.observe(image,"load",OpenLayers.Util.onImageLoad.bindAsEventListener(image)),OpenLayers.Event.observe(image,"error",OpenLayers.Util.onImageLoadError.bindAsEventListener(image))),image.style.alt=a,image.galleryImg="no",d&&(image.src=d),a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv")),e||(e="relative"),OpenLayers.Util.modifyDOMElement(image,a,b,c,e,f,null,g),image},OpenLayers.Util.setOpacity=function(a,b){OpenLayers.Util.modifyDOMElement(a,null,null,null,null,null,null,b)},OpenLayers.Util.onImageLoad=function(){this.style.backgroundColor=null,this.style.display=""},OpenLayers.Util.onImageLoadErrorColor="pink",OpenLayers.Util.onImageLoadError=function(){this.style.backgroundColor=OpenLayers.Util.onImageLoadErrorColor,this.style.display=""},OpenLayers.Util.alphaHack=function(){var a=navigator.appVersion.split("MSIE"),b=parseFloat(a[1]),c=!1;try{c=document.body.filters}catch(d){}return c&&b>=5.5&&b<7},OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){OpenLayers.Util.modifyDOMElement(a,b,c,d);var j=a.childNodes[0];e&&(j.src=e),OpenLayers.Util.modifyDOMElement(j,a.id+"_innerImage",null,d,"relative",g),i&&(a.style.opacity=i,a.style.filter="alpha(opacity="+i*100+")"),OpenLayers.Util.alphaHack()&&(a.style.display="inline-block",h==null&&(h="scale"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+j.src+"', "+"sizingMethod='"+h+"')",a.style.opacity&&(a.style.filter+=" alpha(opacity="+a.style.opacity*100+")"),j.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){var j=OpenLayers.Util.createDiv(),k=OpenLayers.Util.createImage(null,null,null,null,null,null,!1);return j.appendChild(k),i&&(k.style.display="none",OpenLayers.Event.observe(k,"load",OpenLayers.Util.onImageLoad.bindAsEventListener(j)),OpenLayers.Event.observe(k,"error",OpenLayers.Util.onImageLoadError.bindAsEventListener(j))),OpenLayers.Util.modifyAlphaImageDiv(j,a,b,c,d,e,f,g,h),j},OpenLayers.Util.upperCaseObject=function(a){var b=new Object;for(var c in a)b[c.toUpperCase()]=a[c];return b},OpenLayers.Util.applyDefaults=function(a,b){for(var c in b)a[c]==null&&(a[c]=b[c])},OpenLayers.Util.getParameterString=function(a){paramsArray=new Array;for(var b in a){var c=a[b];c!=null&&typeof c!="function"&&paramsArray.push(b+"="+c)}return paramsArray.join("&")},OpenLayers.ImgPath="",OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.Try=function(){var a;for(var b=0;b<arguments.length;b++){var c=arguments[b];try{a=c();break}catch(d){}}return a},OpenLayers.Util.getNodes=function(a,b){var c=OpenLayers.Util.Try(function(){return OpenLayers.Util._getNodes(a.documentElement.childNodes,b)},function(){return OpenLayers.Util._getNodes(a.childNodes,b)});return c},OpenLayers.Util._getNodes=function(a,b){var c=new Array;for(var d=0;d<a.length;d++)a[d].nodeName==b&&c.push(a[d]);return c},OpenLayers.Util.getTagText=function(a,b,c){var d=OpenLayers.Util.getNodes(a,b);if(!(d&&d.length>0))return"";c||(c=0);if(d[c].childNodes.length>1)return d.childNodes[1].nodeValue;if(d[c].childNodes.length==1)return d[c].firstChild.nodeValue},OpenLayers.Util.getXmlNodeValue=function(a){var b=null;return OpenLayers.Util.Try(function(){b=a.text,b||(b=a.textContent),b||(b=a.firstChild.nodeValue)},function(){b=a.textContent}),b},OpenLayers.Util.mouseLeft=function(a,b){var c=a.relatedTarget?a.relatedTarget:a.toElement;while(c!=b&&c!=null)c=c.parentNode;return c!=b},OpenLayers.Util.rad=function(a){return a*Math.PI/180},OpenLayers.Util.distVincenty=function(a,b){var c=6378137,d=6356752.3142,e=1/298.257223563,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-e)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-e)*Math.tan(OpenLayers.Util.rad(b.lat))),i=Math.sin(g),j=Math.cos(g),k=Math.sin(h),l=Math.cos(h),m=f,n=2*Math.PI,o=20;while(Math.abs(m-n)>1e-12&&--o>0){var p=Math.sin(m),q=Math.cos(m),r=Math.sqrt(l*p*l*p+(j*k-i*l*q)*(j*k-i*l*q));if(r==0)return 0;var s=i*k+j*l*q,t=Math.atan2(r,s),u=Math.asin(j*l*p/r),v=Math.cos(u)*Math.cos(u),w=s-2*i*k/v,x=e/16*v*(4+e*(4-3*v));n=m,m=f+(1-x)*e*Math.sin(u)*(t+x*r*(w+x*s*(-1+2*w*w)))}if(o==0)return NaN;var y=v*(c*c-d*d)/(d*d),z=1+y/16384*(4096+y*(-768+y*(320-175*y))),A=y/1024*(256+y*(-128+y*(74-47*y))),B=A*r*(w+A/4*(s*(-1+2*w*w)-A/6*w*(-3+4*r*r)*(-3+4*w*w))),C=d*z*(t-B),D=C.toFixed(3)/1e3;return D},OpenLayers.Util.getArgs=function(){var a=new Object,b=location.search.substring(1),c=b.split("&");for(var d=0;d<c.length;d++){var e=c[d].indexOf("=");if(e==-1)continue;var f=c[d].substring(0,e),g=c[d].substring(e+1);a[f]=unescape(g)}return a},OpenLayers.Util.createUniqueID=function(a){return a==null&&(a="id_"),a+Math.round(Math.random()*1e4)},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(a){var b=a>1?1/a:a;return b},OpenLayers.Util.getResolutionFromScale=function(a,b){b==null&&(b="degrees");var c=OpenLayers.Util.normalizeScale(a),d=1/(c*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH);return d},OpenLayers.Util.getScaleFromResolution=function(a,b){b==null&&(b="degrees");var c=a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH;return c},OpenLayers.Util.safeStopPropagation=function(a){a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},OpenLayers.Util.pagePosition=function(a){var b=0,c=0,d=a;do{b+=d.offsetTop||0,c+=d.offsetLeft||0;if(d.offsetParent==document.body&&OpenLayers.Element.getStyle(d,"position")=="absolute")break}while(d=d.offsetParent);d=a;do b-=d.scrollTop||0,c-=d.scrollLeft||0;while(d=d.parentNode);return[c,b]};var Rico=new Object;Rico.Corner={round:function(a,b){var a=$(a);this._setOptions(b);var c=this.options.color;this.options.color=="fromElement"&&(c=this._background(a));var d=this.options.bgColor;this.options.bgColor=="fromParent"&&(d=this._background(a.offsetParent)),this._roundCornersImpl(a,c,d)},changeColor:function(a,b){a.style.backgroundColor=b;var c=a.parentNode.getElementsByTagName("span");for(var d=0;d<c.length;d++)c[d].style.backgroundColor=b},changeOpacity:function(a,b){var c=b,d="alpha(opacity="+b*100+")";a.style.opacity=c,a.style.filter=d;var e=a.parentNode.getElementsByTagName("span");for(var f=0;f<e.length;f++)e[f].style.opacity=c,e[f].style.filter=d},reRound:function(a,b){var c=a.parentNode.childNodes[0],d=a.parentNode.childNodes[2];a.parentNode.removeChild(c),a.parentNode.removeChild(d),this.round(a.parentNode,b)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c),this._isTopRounded()&&this._roundTopCorners(a,b,c),this._isBottomRounded()&&this._roundBottomCorners(a,b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b),d="border-left: "+c,e="border-right: "+c,f="style='"+d+";"+e+"'";a.innerHTML="<div "+f+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){var d=this._createCorner(c);for(var e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0,a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){var d=this._createCorner(c);for(var e=this.options.numSlices-1;e>=0;e--)d.appendChild(this._createCornerSlice(b,c,e,"bottom"));a.style.paddingBottom=0,a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");return b.style.backgroundColor=this._isTransparent()?"transparent":a,b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a,f.display="block",f.height="1px",f.overflow="hidden",f.fontSize="1px";var g=this._borderColor(a,b);return this.options.border&&c==0?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth="0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=g):g&&(f.borderColor=g,f.borderStyle="solid",f.borderWidth="0px 1px"),!this.options.compact&&c==this.options.numSlices-1&&(f.height="2px"),this._setMargin(e,c,d),this._setBorder(e,c,d),e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},OpenLayers.Util.extend(this.options,a||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")?"":this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0?"":this.options.corners.indexOf("tl")>=0?"left":this.options.corners.indexOf("tr")>=0?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")?"":this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0?"":this.options.corners.indexOf("bl")>=0?"left":this.options.corners.indexOf("br")>=0?"right":""},_borderColor:function(a,b){return a=="transparent"?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){var d=this._marginSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.marginLeft=d+"px",a.style.marginRight="0px"):e=="right"?(a.style.marginRight=d+"px",a.style.marginLeft="0px"):(a.style.marginLeft=d+"px",a.style.marginRight=d+"px")},_setBorder:function(a,b,c){var d=this._borderSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth="0px"):e=="right"?(a.style.borderRightWidth=d+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth=d+"px"),this.options.border!=0&&(a.style.borderLeftWidth=d+"px"),a.style.borderRightWidth=d+"px"},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?d[a]:this.options.blend?c[a]:this.options.border?e[a]:this._isTransparent()?b[a]:0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(a.indexOf(arguments[b])>=0)return!0;return!1},_blend:function(a,b){var c=Rico.Color.createFromHex(a);return c.blend(Rico.Color.createFromHex(b)),c},_background:function(a){try{return Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return a.childNodes.length==1&&a.childNodes[0].nodeType==3}},OpenLayers.ProxyHost="",OpenLayers.nullHandler=function(a){alert("Unhandled request return "+a.statusText)},OpenLayers.loadURL=function(a,b,c,d,e){OpenLayers.ProxyHost&&a.startsWith("http")&&(a=OpenLayers.ProxyHost+escape(a));var f=d?d.bind(c):OpenLayers.nullHandler,g=e?e.bind(c):OpenLayers.nullHandler;new OpenLayers.Ajax.Request(a,{method:"get",parameters:b,onComplete:f,onFailure:g})},OpenLayers.parseXMLString=function(a){var b=a.indexOf("<");b>0&&(a=a.substring(b));var c=OpenLayers.Util.Try(function(){var b=new ActiveXObject("Microsoft.XMLDOM");return b.loadXML(a),b},function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;return b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1),b.overrideMimeType&&b.overrideMimeType("text/xml"),b.send(null),b.responseXML});return c},OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new XMLHttpRequest})||!1},activeRequestCount:0},OpenLayers.Ajax.Responders={responders:[],register:function(a){for(var b=0;b<this.responders.length;b++)if(a==this.responders[b])return;this.responders.push(a)},dispatch:function(a,b,c,d){for(var e=0;e<this.responders.length;e++){responder=this.responders[e];if(responder[a]&&typeof responder[a]=="function")try{responder[a].apply(responder,[b,c,d])}catch(f){}}}},OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--}}),OpenLayers.Ajax.Base=function(){},OpenLayers.Ajax.Base.prototype={setOptions:function(a){this.options={method:"post",asynchronous:!0,parameters:""},OpenLayers.Util.extend(this.options,a||{})},responseIsSuccess:function(){return this.transport.status==undefined||this.transport.status==0||this.transport.status>=200&&this.transport.status<300},responseIsFailure:function(){return!this.responseIsSuccess()}},OpenLayers.Ajax.Request=OpenLayers.Class.create(),OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],OpenLayers.Ajax.Request.prototype=OpenLayers.Class.inherit(OpenLayers.Ajax.Base,{initialize:function(a,b){this.transport=OpenLayers.Ajax.getTransport(),this.setOptions(b),this.request(a)},request:function(a){var b=this.options.parameters||"";b.length>0&&(b+="&_=");try{this.url=a,this.options.method=="get"&&b.length>0&&(this.url+=(this.url.match(/\?/)?"&":"?")+b),OpenLayers.Ajax.Responders.dispatch("onCreate",this,this.transport),this.transport.open(this.options.method,this.url,this.options.asynchronous),this.options.asynchronous&&(this.transport.onreadystatechange=this.onStateChange.bind(this),setTimeout(function(){this.respondToReadyState(1)}.bind(this),10)),this.setRequestHeaders();var c=this.options.postBody?this.options.postBody:b;this.transport.send(this.options.method=="post"?c:null)}catch(d){this.dispatchException(d)}},setRequestHeaders:function(){var a=["X-Requested-With","XMLHttpRequest","X-Prototype-Version","OpenLayers"];this.options.method=="post"&&(a.push("Content-type","application/x-www-form-urlencoded"),this.transport.overrideMimeType&&a.push("Connection","close")),this.options.requestHeaders&&a.push.apply(a,this.options.requestHeaders);for(var b=0;b<a.length;b+=2)this.transport.setRequestHeader(a[b],a[b+1])},onStateChange:function(){var a=this.transport.readyState;a!=1&&this.respondToReadyState(this.transport.readyState)},header:function(a){try{return this.transport.getResponseHeader(a)}catch(b){}},evalJSON:function(){try{return eval(this.header("X-JSON"))}catch(e){}},evalResponse:function(){try{return eval(this.transport.responseText)}catch(e){this.dispatchException(e)}},respondToReadyState:function(a){var b=OpenLayers.Ajax.Request.Events[a],c=this.transport,d=this.evalJSON();if(b=="Complete"){try{(this.options["on"+this.transport.status]||this.options["on"+(this.responseIsSuccess()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(c,d)}catch(e){this.dispatchException(e)}(this.header("Content-type")||"").match(/^text\/javascript/i)&&this.evalResponse()}try{(this.options["on"+b]||OpenLayers.Ajax.emptyFunction)(c,d),OpenLayers.Ajax.Responders.dispatch("on"+b,this,c,d)}catch(e){this.dispatchException(e)}b=="Complete"&&(this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction)},dispatchException:function(a){(this.options.onException||OpenLayers.Ajax.emptyFunction)(this,a),OpenLayers.Ajax.Responders.dispatch("onException",this,a)}}),OpenLayers.Ajax.getElementsByTagNameNS=function(a,b,c,d){return a.getElementsByTagNameNS?a.getElementsByTagNameNS(b,d):a.getElementsByTagName(c+":"+d)},OpenLayers.Control=OpenLayers.Class.create(),OpenLayers.Control.prototype={id:null,map:null,div:null,position:null,mouseDragStart:null,initialize:function(a){OpenLayers.Util.extend(this,a),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.map=null},setMap:function(a){this.map=a},draw:function(a){return this.div==null&&(this.div=OpenLayers.Util.createDiv(),this.div.id=this.id,this.div.className="olControl"),a!=null&&(this.position=a.clone()),this.moveTo(this.position),this.div},moveTo:function(a){a!=null&&this.div!=null&&(this.div.style.left=a.x+"px",this.div.style.top=a.x+"px")},CLASS_NAME:"OpenLayers.Control"},OpenLayers.Control.OverviewMap=OpenLayers.Class.create(),OpenLayers.Control.OverviewMap.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{id:"OverviewMap",element:null,ovmap:null,layers:[],minRatio:8,maxRatio:32,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!(this.layers.length>0)){if(!this.map.baseLayer)return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;var a=this.map.baseLayer.clone();this.layers=[a]}this.element=document.createElement("div"),this.element.className="olControlOverviewMapElement",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width="180px",this.mapDiv.style.height="90px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.style.backgroundImage="url("+OpenLayers.Util.getImagesLocation()+"/blank.png)",this.extentRectangle.className="olControlOverviewMapExtentRectangle",this.mapDiv.appendChild(this.extentRectangle),this.element.appendChild(this.mapDiv),this.div.appendChild(this.element),this.div.className="olControlOverviewMapContainer",this.map.events.register("moveend",this,this.update),this.elementEvents=new OpenLayers.Events(this,this.element),this.elementEvents.register("mousedown",this,function(a){OpenLayers.Event.stop(a)}),this.elementEvents.register("click",this,function(a){OpenLayers.Event.stop(a)}),this.elementEvents.register("dblclick",this,function(a){OpenLayers.Event.stop(a)}),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle),this.rectEvents.register("mouseover",this,this.rectMouseOver),this.rectEvents.register("mouseout",this,this.rectMouseOut),this.rectEvents.register("mousedown",this,this.rectMouseDown),this.rectEvents.register("mousemove",this,this.rectMouseMove),this.rectEvents.register("mouseup",this,this.rectMouseUp),this.rectEvents.register("click",this,function(a){OpenLayers.Event.stop(a)}),this.rectEvents.register("dblclick",this,this.rectDblClick),this.mapDivEvents=new OpenLayers.Events(this,this.mapDiv),this.mapDivEvents.register("click",this,this.mapDivClick);var b=OpenLayers.Util.getImagesLocation(),c=b+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("olControlOverviewMapMaximizeButton",null,new OpenLayers.Size(18,18),c,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className="olControlOverviewMapMaximizeButton",OpenLayers.Event.observe(this.maximizeDiv,"click",this.maximizeControl.bindAsEventListener(this)),this.div.appendChild(this.maximizeDiv);var c=b+"layer-switcher-minimize.png";return this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,new OpenLayers.Size(18,18),c,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className="olControlOverviewMapMinimizeButton",OpenLayers.Event.observe(this.minimizeDiv,"click",this.minimizeControl.bindAsEventListener(this)),this.div.appendChild(this.minimizeDiv),this.minimizeControl(),this.div},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectMouseOver:function(a){this.extentRectangle.style.cursor="move"},rectMouseOut:function(a){this.extentRectangle.style.cursor="default",this.rectDragStart!=null&&
(this.performedRectDrag&&this.updateMapToRect(),document.onselectstart=null,this.rectDragStart=null)},rectMouseDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.rectDragStart=a.xy.clone(),this.performedRectDrag=!1,OpenLayers.Event.stop(a)},rectMouseMove:function(a){if(this.rectDragStart!=null){var b=this.rectDragStart.x-a.xy.x,c=this.rectDragStart.y-a.xy.y,d=this.getRectPxBounds(),e=d.top,f=d.left,g=Math.abs(d.getHeight()),h=d.getWidth(),i=Math.max(0,e-c);i=Math.min(i,this.ovmap.size.h-this.hComp-g);var j=Math.max(0,f-b);j=Math.min(j,this.ovmap.size.w-this.wComp-h),this.setRectPxBounds(new OpenLayers.Bounds(j,i+g,j+h,i)),this.rectDragStart=a.xy.clone(),this.performedRectDrag=!0,OpenLayers.Event.stop(a)}},rectMouseUp:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.performedRectDrag&&(this.updateMapToRect(),OpenLayers.Event.stop(a)),document.onselectstart=null,this.rectDragStart=null},rectDblClick:function(a){this.performedRectDrag=!1,OpenLayers.Event.stop(a),this.updateOverview()},mapDivClick:function(a){var b=this.getRectPxBounds(),c=b.getCenterPixel(),d=a.xy.x-c.x,e=a.xy.y-c.y,f=b.top,g=b.left,h=Math.abs(b.getHeight()),i=b.getWidth(),j=Math.max(0,f+e);j=Math.min(j,this.ovmap.size.h-h);var k=Math.max(0,g+d);k=Math.min(k,this.ovmap.size.w-i),this.setRectPxBounds(new OpenLayers.Bounds(k,j+h,k+i,j)),this.updateMapToRect(),OpenLayers.Event.stop(a)},maximizeControl:function(a){this.element.style.display="",this.showToggle(!1),a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none",this.showToggle(!0),a!=null&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none",this.minimizeDiv.style.display=a?"none":""},update:function(){this.ovmap==null&&this.createMap(),this.isSuitableOverview()||this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.maxExtent,c=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top)),d=this.ovmap.getResolution()/this.map.getResolution();return d>this.minRatio&&d<=this.maxRatio&&this.ovmap.getExtent().containsBounds(c)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a),this.ovmap.setCenter(this.map.center,this.ovmap.getZoomForResolution(b)),this.updateRectToMap()},createMap:function(){this.ovmap=new OpenLayers.Map(this.mapDiv.id,{controls:[],maxResolution:"auto"}),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2},updateRectToMap:function(){this.map.units!="degrees"&&this.map.projection!=this.ovmap.map.projection&&alert("The overview map only works when it is in the same projection as the main map");var a=this.getRectBoundsFromMapBounds(this.map.getExtent());this.setRectPxBounds(a)},updateMapToRect:function(){var a=this.getRectPxBounds(),b=this.getMapBoundsFromRectBounds(a);this.map.setCenter(b.getCenterLonLat(),this.map.zoom)},getRectPxBounds:function(){var a=parseInt(this.extentRectangle.style.top),b=parseInt(this.extentRectangle.style.left),c=parseInt(this.extentRectangle.style.height),d=parseInt(this.extentRectangle.style.width);return new OpenLayers.Bounds(b,a+c,b+d,a)},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),e=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp);this.extentRectangle.style.top=parseInt(b)+"px",this.extentRectangle.style.left=parseInt(c)+"px",this.extentRectangle.style.height=parseInt(d-b)+"px",this.extentRectangle.style.width=parseInt(e-c)+"px"},getRectBoundsFromMapBounds:function(a){var b=new OpenLayers.LonLat(a.left,a.bottom),c=new OpenLayers.LonLat(a.right,a.top),d=this.getOverviewPxFromLonLat(b),e=this.getOverviewPxFromLonLat(c);return new OpenLayers.Bounds(d.x,d.y,e.x,e.y)},getMapBoundsFromRectBounds:function(a){var b=new OpenLayers.Pixel(a.left,a.bottom),c=new OpenLayers.Pixel(a.right,a.top),d=this.getLonLatFromOverviewPx(b),e=this.getLonLatFromOverviewPx(c);return new OpenLayers.Bounds(d.lon,d.lat,e.lon,e.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat(),e=a.x-b.w/2,f=a.y-b.h/2;return new OpenLayers.LonLat(d.lon+e*c,d.lat-f*c)},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent();return new OpenLayers.Pixel(Math.round(1/b*(a.lon-c.left)),Math.round(1/b*(c.top-a.lat)))},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),OpenLayers.Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isLeftClick:function(a){return a.which&&a.which==1||a.button&&a.button==1},pointerX:function(a){return a.pageX||a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)},pointerY:function(a){return a.pageY||a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)},stop:function(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0)},findElement:function(a,b){var c=OpenLayers.Event.element(a);while(c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase()))c=c.parentNode;return c},observers:!1,_observeAndCache:function(a,b,c,d){this.observers||(this.observers=[]),a.addEventListener?(this.observers.push([a,b,c,d]),a.addEventListener(b,c,d)):a.attachEvent&&(this.observers.push([a,b,c,d]),a.attachEvent("on"+b,c))},unloadCache:function(){if(!OpenLayers.Event.observers)return;for(var a=0;a<OpenLayers.Event.observers.length;a++)OpenLayers.Event.stopObserving.apply(this,OpenLayers.Event.observers[a]),OpenLayers.Event.observers[a][0]=null;OpenLayers.Event.observers=!1},observe:function(a,b,c,d){var e=$(a);d=d||!1,b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||e.attachEvent)&&(b="keydown"),this._observeAndCache(e,b,c,d)},stopObserving:function(a,b,c,d){var e=$(a);d=d||!1,b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||e.detachEvent)&&(b="keydown"),e.removeEventListener?e.removeEventListener(b,c,d):e.detachEvent&&e.detachEvent("on"+b,c)}},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);if(window.Event)OpenLayers.Util.extend(window.Event,OpenLayers.Event);else var Event=OpenLayers.Event;OpenLayers.Events=OpenLayers.Class.create(),OpenLayers.Events.prototype={BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","resize","focus","blur"],listeners:null,object:null,element:null,eventTypes:null,initialize:function(a,b,c,d){this.object=a,this.element=b,this.eventTypes=c,this.fallThrough=d,this.listeners=new Object;if(this.eventTypes!=null)for(var e=0;e<this.eventTypes.length;e++)this.listeners[this.eventTypes[e]]=new Array;this.element!=null&&this.attachToElement(b)},attachToElement:function(a){for(var b=0;b<this.BROWSER_EVENTS.length;b++){var c=this.BROWSER_EVENTS[b];this.listeners[c]==null&&(this.listeners[c]=new Array),OpenLayers.Event.observe(a,c,this.handleBrowserEvent.bindAsEventListener(this))}OpenLayers.Event.observe(a,"dragstart",OpenLayers.Event.stop)},register:function(a,b,c){if(c!=null){b==null&&(b=this.object);var d=this.listeners[a];d!=null&&d.push({obj:b,func:c})}},unregister:function(a,b,c){b==null&&(b=this.object);var d=this.listeners[a];if(d!=null)for(var e=0;e<d.length;e++)if(d[e].obj==b&&d[e].func==c){d.splice(e,1);break}},remove:function(a){this.listeners[a]!=null&&(this.listeners[a]=new Array)},triggerEvent:function(a,b){b==null&&(b=new Object),b.object=this.object,b.element=this.element;var c=this.listeners[a];if(c!=null&&c.length>0){for(var d=0;d<c.length;d++){var e=c[d],f;e.obj!=null?f=e.func.call(e.obj,b):f=e.func(b);if(f!=null&&f==0)break}this.fallThrough||OpenLayers.Util.safeStopPropagation(b)}},handleBrowserEvent:function(a){a.xy=this.getMousePosition(a),this.triggerEvent(a.type,a)},getMousePosition:function(a){return this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element),this.element.offsets[0]+=document.documentElement.scrollLeft||document.body.scrollLeft,this.element.offsets[1]+=document.documentElement.scrollTop||document.body.scrollTop),new OpenLayers.Pixel(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-this.element.offsets[0],a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-this.element.offsets[1])},CLASS_NAME:"OpenLayers.Events"},OpenLayers.Icon=OpenLayers.Class.create(),OpenLayers.Icon.prototype={url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a,this.size=b?b:new OpenLayers.Size(20,20),this.offset=c,this.calculateOffset=d?d:function(a){return new OpenLayers.Pixel(-(a.w/2),-(a.h/2))},this.imageDiv=OpenLayers.Util.createAlphaImageDiv()},destroy:function(){this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(a){a!=null&&(this.size=a),this.draw()},draw:function(a){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(a),this.imageDiv},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,a)},moveTo:function(a){a!=null&&(this.px=a);if(this.imageDiv!=null)if(this.px==null)this.display(!1);else{this.calculateOffset&&(this.offset=this.calculateOffset(this.size));var b=this.px.offset(this.offset);OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,b),this.display(!0)}},display:function(a){this.imageDiv.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Icon"},OpenLayers.Layer=OpenLayers.Class.create(),OpenLayers.Layer.prototype={id:null,name:null,div:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,inRange:!1,options:null,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,initialize:function(a,b){this.options=OpenLayers.Util.extend(new Object,b),OpenLayers.Util.extend(this,this.options),this.name=a,this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div==null&&(this.div=OpenLayers.Util.createDiv(),this.div.style.width="100%",this.div.style.height="100%",this.div.id=this.id)},destroy:function(){this.map!=null&&this.map.removeLayer(this),this.map=null,this.name=null,this.div=null,this.options=null},clone:function(a){return a==null&&(a=new OpenLayers.Layer(this.name,this.options)),OpenLayers.Util.applyDefaults(a,this),a.map=null,a},setName:function(a){this.name=a,this.map!=null&&this.map.events.triggerEvent("changelayer")},addOptions:function(a){OpenLayers.Util.extend(this.options,a),OpenLayers.Util.extend(this,a)},onMapResize:function(){},moveTo:function(a,b,c){var d=this.visibility;this.isBaseLayer||(d=d&&this.inRange),this.display(d)},setMap:function(a){this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.projection=this.projection||this.map.projection,this.units=this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange())},getVisibility:function(){return this.visibility},setVisibility:function(a,b){if(a!=this.visibility){this.visibility=a,this.display(a);if(this.map!=null){var c=this.map.getExtent();c!=null&&this.moveTo(c,!0)}this.map!=null&&(b==null||b==0)&&this.map.events.triggerEvent("changelayer")}},display:function(a){a!=(this.div.style.display!="none")&&(this.div.style.display=a?"block":"none")},calculateInRange:function(){var a=!1;if(this.map){var b=this.map.getResolution();a=b>=this.minResolution&&b<=this.maxResolution}return a},setIsBaseLayer:function(a){this.isBaseLayer=a,this.map!=null&&this.map.events.triggerEvent("changelayer")},initResolutions:function(){var a=new Array("projection","units","scales","resolutions","maxScale","minScale","maxResolution","minResolution","minExtent","maxExtent","numZoomLevels","maxZoomLevel"),b=new Object;for(var c=0;c<a.length;c++){var d=a[c];b[d]=this.options[d]||this.map[d]}!b.numZoomLevels&&b.maxZoomLevel&&(b.numZoomLevels=b.maxZoomLevel+1);if(b.scales!=null||b.resolutions!=null){if(b.scales!=null){b.resolutions=new Array;for(var c=0;c<b.scales.length;c++){var e=b.scales[c];b.resolutions[c]=OpenLayers.Util.getResolutionFromScale(e,b.units)}}b.numZoomLevels=b.resolutions.length}else{b.resolutions=new Array;if(b.minScale)b.maxResolution=OpenLayers.Util.getResolutionFromScale(b.minScale,b.units);else if(b.maxResolution=="auto"){var f=this.map.getSize(),g=b.maxExtent.getWidth()/f.w,h=b.maxExtent.getHeight()/f.h;b.maxResolution=Math.max(g,h)}if(b.maxScale!=null)b.minResolution=OpenLayers.Util.getResolutionFromScale(b.maxScale);else if(b.minResolution=="auto"&&b.minExtent!=null){var f=this.map.getSize(),g=b.minExtent.getWidth()/f.w,h=b.minExtent.getHeight()/f.h;b.minResolution=Math.max(g,h)}if(b.minResolution!=null){var i=b.maxResolution/b.minResolution;b.numZoomLevels=Math.floor(Math.log(i)/Math.log(2))+1}for(var c=0;c<b.numZoomLevels;c++){var j=b.maxResolution/Math.pow(2,c);b.resolutions.push(j)}}b.resolutions.sort(function(a,b){return b-a}),this.resolutions=b.resolutions,this.maxResolution=b.resolutions[0];var k=b.resolutions.length-1;this.minResolution=b.resolutions[k],this.scales=new Array;for(var c=0;c<b.resolutions.length;c++)this.scales[c]=OpenLayers.Util.getScaleFromResolution(b.resolutions[c],b.units);this.minScale=this.scales[0],this.maxScale=this.scales[this.scales.length-1],this.numZoomLevels=b.numZoomLevels},getResolution:function(){var a=this.map.getZoom();return this.resolutions[a]},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a){var b=this.map.getSize(),c=Math.max(a.getWidth()/b.w,a.getHeight()/b.h);return this.getZoomForResolution(c)},getZoomForResolution:function(a){for(var b=1;b<this.resolutions.length;b++)if(this.resolutions[b]<a)break;return b-1},getLonLatFromViewPortPx:function(a){var b=null;if(a!=null){var c=this.map.getSize(),d=this.map.getCenter(),e=this.map.getResolution(),f=a.x-c.w/2,g=a.y-c.h/2;b=new OpenLayers.LonLat(d.lon+f*e,d.lat-g*e)}return b},getViewPortPxFromLonLat:function(a){var b=null;if(a!=null){var c=this.map.getResolution(),d=this.map.getExtent();b=new OpenLayers.Pixel(Math.round(1/c*(a.lon-d.left)),Math.round(1/c*(d.top-a.lat)))}return b},setOpacity:function(a){this.opacity=a;for(var b=0;b<this.div.childNodes.length;++b){var c=this.div.childNodes[b];OpenLayers.Util.modifyDOMElement(c,null,null,null,null,null,null,a)}},setZIndex:function(a){this.div.style.zIndex=a},CLASS_NAME:"OpenLayers.Layer"},OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class.create(),OpenLayers.Layer.FixedZoomLevels.prototype={initialize:function(){},initResolutions:function(){var a=new Array("minZoomLevel","maxZoomLevel","numZoomLevels");for(var b=0;b<a.length;b++){var c=a[b];this[c]=this.options[c]!=null?this.options[c]:this.map[c]}if(this.minZoomLevel==null||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;var d=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(this.numZoomLevels!=null)this.numZoomLevels=Math.min(this.numZoomLevels,d);else if(this.maxZoomLevel!=null){var e=this.maxZoomLevel-this.minZoomLevel+1;this.numZoomLevels=Math.min(e,d)}else this.numZoomLevels=d;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var f=0;this.resolutions=[];for(var b=this.minZoomLevel;b<this.numZoomLevels;b++)this.resolutions[f++]=this.RESOLUTIONS[b]}},getResolution:function(){if(this.resolutions!=null)return OpenLayers.Layer.prototype.getResolution.apply(this,arguments);var a=null,b=this.map.getSize(),c=this.getExtent();return b!=null&&c!=null&&(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h)),a},getExtent:function(){var a=null,b=this.map.getSize(),c=new OpenLayers.Pixel(0,0),d=this.getLonLatFromViewPortPx(c),e=new OpenLayers.Pixel(b.w,b.h),f=this.getLonLatFromViewPortPx(e);return d!=null&&f!=null&&(a=new OpenLayers.Bounds(d.lon,f.lat,f.lon,d.lat)),a},getZoomForResolution:function(a){if(this.resolutions!=null)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var b=OpenLayers.Layer.prototype.getExtent.apply(this,[a]);return this.getZoomForExtent(b)},getOLZoomFromMapObjectZoom:function(a){var b=null;return a!=null&&(b=a-this.minZoomLevel),b},getMapObjectZoomFromOLZoom:function(a){var b=null;return a!=null&&(b=a+this.minZoomLevel),b},CLASS_NAME:"FixedZoomLevels.js"},OpenLayers.Marker=OpenLayers.Class.create(),OpenLayers.Marker.prototype={icon:null,lonlat:null,events:null,map:null,initialize:function(a,b){this.lonlat=a;var c=b?b:OpenLayers.Marker.defaultIcon();this.icon==null?this.icon=c:(this.icon.url=c.url,this.icon.size=c.size,this.icon.offset=c.offset,this.icon.calculateOffset=c.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv,null)},destroy:function(){this.map=null,this.icon!=null&&(this.icon.destroy(),this.icon=null)},draw:function(a){return this.icon.draw(a)},moveTo:function(a){a!=null&&this.icon!=null&&this.icon.moveTo(a)},onScreen:function(){var a=!1;if(this.map){var b=this.map.getExtent();a=b.containsLonLat(this.lonlat)}return a},inflate:function(a){if(this.icon){var b=new OpenLayers.Size(this.icon.size.w*a,this.icon.size.h*a);this.icon.setSize(b)}},setOpacity:function(a){this.icon.setOpacity(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"},OpenLayers.Marker.defaultIcon=function(){var a=OpenLayers.Util.getImagesLocation()+"marker.png",b=new OpenLayers.Size(21,25);return new OpenLayers.Icon(a,b)},OpenLayers.Popup=OpenLayers.Class.create(),OpenLayers.Popup.WIDTH=200,OpenLayers.Popup.HEIGHT=200,OpenLayers.Popup.COLOR="white",OpenLayers.Popup.OPACITY=1,OpenLayers.Popup.BORDER="0px",OpenLayers.Popup.prototype={events:null,id:"",lonlat:null,div:null,size:null,contentHTML:"",backgroundColor:"",opacity:"",border:"",contentDiv:null,padding:5,map:null,initialize:function(a,b,c,d,e){a==null&&(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")),this.id=a,this.lonlat=b,this.size=c!=null?c:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT),d!=null&&(this.contentHTML=d),this.backgroundColor=OpenLayers.Popup.COLOR,this.opacity=OpenLayers.Popup.OPACITY,this.border=OpenLayers.Popup.BORDER,this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden"),this.div.className="olPopup";var a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.size.clone(),null,"relative",null,"hidden"),this.contentDiv.className="olPopupContent",this.div.appendChild(this.contentDiv);if(e==1){var f=new OpenLayers.Size(17,17),g=OpenLayers.Util.getImagesLocation()+"close.gif",h=OpenLayers.Util.createAlphaImageDiv(this.id+"_close",null,f,g);h.style.right=this.padding+"px",h.style.top=this.padding+"px",this.div.appendChild(h);var i=new OpenLayers.Events(this,h);i.register("mousedown",this,this.hide)}this.registerEvents()},destroy:function(){this.map!=null&&this.map.removePopup(this),this.div=null,this.map=null},draw:function(a){return a==null&&this.lonlat!=null&&this.map!=null&&(a=this.map.getLayerPxFromLonLat(this.lonlat)),this.setSize(),this.setBackgroundColor(),this.setOpacity(),this.setBorder(),this.setContentHTML(),this.moveTo(a),this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(a)}},moveTo:function(a){a!=null&&this.div!=null&&(this.div.style.left=a.x+"px",this.div.style.top=a.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){OpenLayers.Element.toggle(this.div)},show:function(){OpenLayers.Element.show(this.div)},hide:function(){OpenLayers.Element.hide(this.div)},setSize:function(a){a!=undefined&&(this.size=a),this.div!=null&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px")},setBackgroundColor:function(a){a!=undefined&&(this.backgroundColor=a),this.div!=null&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(a){a!=undefined&&(this.opacity=a),this.div!=null&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+this.opacity*100+")")},setBorder:function(a){a!=undefined&&(this.border=a),this.div!=null&&(this.div.style.border=this.border)},setContentHTML:function(a){a!=null&&(this.contentHTML=a),this.contentDiv!=null&&(this.contentDiv.innerHTML=this.contentHTML)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0),this.events.register("mousedown",this,this.onmousedown),this.events.register("mousemove",this,this.onmousemove),this.events.register("mouseup",this,this.onmouseup),this.events.register("click",this,OpenLayers.Util.safeStopPropagation),this.events.register("mouseout",this,this.onmouseout),this.events.register("dblclick",this,OpenLayers.Util.safeStopPropagation)},onmousedown:function(a){this.mousedown=!0,OpenLayers.Util.safeStopPropagation(a)},onmousemove:function(a){this.mousedown&&OpenLayers.Util.safeStopPropagation(a)},onmouseup:function(a){this.mousedown&&(this.mousedown=!1,OpenLayers.Util.safeStopPropagation(a))},onmouseout:function(a){this.mousedown=!1},CLASS_NAME:"OpenLayers.Popup"},OpenLayers.Tile=OpenLayers.Class.create(),OpenLayers.Tile.prototype={id:null,layer:null,url:null,bounds:null,size:null,position:null,drawn:!1,initialize:function(a,b,c,d,e){this.layer=a,this.position=b,this.bounds=c,this.url=d,this.size=e,this.id=OpenLayers.Util.createUniqueID("Tile_")},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null},draw:function(){this.drawn=!0},moveTo:function(a,b,c){c==null&&(c=!0),this.clear(),this.bounds=a.clone(),this.position=b.clone(),c&&this.draw()},clear:function(){this.drawn=!1},getBoundsFromBaseLayer:function(a){var b=this.layer.map.getLonLatFromLayerPx(this.position),c=this.position.clone();c.x+=this.size.w,c.y+=this.size.h;var d=this.layer.map.getLonLatFromLayerPx(c);return b.lon>d.lon&&(b.lon<0?b.lon=-180-(b.lon+180):d.lon=180+d.lon+180),bounds=new OpenLayers.Bounds(b.lon,d.lat,d.lon,b.lat),bounds},CLASS_NAME:"OpenLayers.Tile"},Rico.Color=OpenLayers.Class.create(),Rico.Color.prototype={initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},darken:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){var a=this.asHSB();return this.asHSB().b>.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}},Rico.Color.createFromHex=function(a){if(a.length==4){var b=a,a="#";for(var c=1;c<4;c++)a+=b.charAt(c)+b.charAt(c)}a.indexOf("#")==0&&(a=a.substring(1));var d=a.substring(0,2),e=a.substring(2,4),f=a.substring(4,6);return new Rico.Color(parseInt(d,16),parseInt(e,16),parseInt(f,16))},Rico.Color.createColorFromBackground=function(a){var b=RicoUtil.getElementsComputedStyle($(a),"backgroundColor","background-color");if(b=="transparent"&&a.parentNode)return Rico.Color.createColorFromBackground(a.parentNode);if(b==null)return new Rico.Color(255,255,255);if(b.indexOf("rgb(")==0){var c=b.substring(4,b.length-1),d=c.split(",");return new Rico.Color(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]))}return b.indexOf("#")==0?Rico.Color.createFromHex(b):new Rico.Color(255,255,255)},Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(b==0)d=parseInt(c*255+.5),e=d,f=d;else{var g=(a-Math.floor(a))*6,h=g-Math.floor(g),i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h));switch(parseInt(g)){case 0:d=c*255+.5,e=k*255+.5,f=i*255+.5;break;case 1:d=j*255+.5,e=c*255+.5,f=i*255+.5;break;case 2:d=i*255+.5,e=c*255+.5,f=k*255+.5;break;case 3:d=i*255+.5,e=j*255+.5,f=c*255+.5;break;case 4:d=k*255+.5,e=i*255+.5,f=c*255+.5;break;case 5:d=c*255+.5,e=i*255+.5,f=j*255+.5}}return{r:parseInt(d),g:parseInt(e),b:parseInt(f)}},Rico.Color.RGBtoHSB=function(a,b,c){var d,e,f,g=a>b?a:b;c>g&&(g=c);var h=a<b?a:b;c<h&&(h=c),f=g/255,g!=0?e=(g-h)/g:e=0;if(e==0)d=0;else{var i=(g-a)/(g-h),j=(g-b)/(g-h),k=(g-c)/(g-h);a==g?d=k-j:b==g?d=2+i-k:d=4+j-i,d/=6,d<0&&(d+=1)}return{h:d,s:e,b:f}},OpenLayers.Control.ArgParser=OpenLayers.Class.create(),OpenLayers.Control.ArgParser.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{center:null,zoom:null,layers:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0;b<this.map.controls.length;b++){var c=this.map.controls[b];if(c!=this&&c.CLASS_NAME=="OpenLayers.Control.ArgParser")break}if(b==this.map.controls.length){var d=OpenLayers.Util.getArgs();d.lat&&d.lon&&(this.center=new OpenLayers.LonLat(parseFloat(d.lon),parseFloat(d.lat)),d.zoom&&(this.zoom=parseInt(d.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),this.setCenter()),d.layers&&(this.layers=d.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers())}},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0;a<this.layers.length;a++){var b=this.map.layers[a],c=this.layers.charAt(a);c=="B"?this.map.setBaseLayer(b):(c=="T"||c=="F")&&b.setVisibility(c=="T")}}},CLASS_NAME:"OpenLayers.Control.ArgParser"}),OpenLayers.Control.LayerSwitcher=OpenLayers.Class.create(),OpenLayers.Control.LayerSwitcher.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{activeColor:"darkblue",layersDiv:null,baseLayersDiv:null,baseLayerInputs:null,dataLbl:null,dataLayersDiv:null,dataLayerInputs:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("addlayer",this,this.redraw),this.map.events.register("changelayer",this,this.redraw),this.map.events.register("removelayer",this,this.redraw),this.map.events.register("changebaselayer",this,this.redraw)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this),this.loadContents(),this.minimizeControl(),this.redraw(),this.div},redraw:function(){this.baseLayersDiv.innerHTML="",this.baseLayerInputs=new Array,this.dataLayersDiv.innerHTML="",this.dataLayerInputs=new Array;var a=!1,b=this.map.layers.slice();this.ascending||b.reverse();for(var c=0;c<b.length;c++){var d=b[c],e=d.isBaseLayer;if(e||d.displayInLayerSwitcher){e||(a=!0);var f=e?d==this.map.baseLayer:d.getVisibility(),g=document.createElement("input");g.id="input_"+d.name,g.name=e?"baseLayers":d.name,g.type=e?"radio":"checkbox",g.value=d.name,g.checked=f,g.defaultChecked=f,g.layer=d,g.control=this,!e&&!d.inRange&&(g.disabled=!0),OpenLayers.Event.observe(g,"mouseup",this.onInputClick.bindAsEventListener(g));var h=document.createElement("span");!e&&!d.inRange&&(h.style.color="gray"),h.innerHTML=d.name,h.style.verticalAlign=e?"bottom":"baseline",OpenLayers.Event.observe(h,"click",this.onInputClick.bindAsEventListener(g));var i=document.createElement("br"),j=e?this.baseLayerInputs:this.dataLayerInputs;j.push(g);var k=e?this.baseLayersDiv:this.dataLayersDiv;k.appendChild(g),k.appendChild(h),k.appendChild(i)}}return this.dataLbl.style.display=a?"":"none",this.div},onInputClick:function(a){this.disabled||(this.type=="radio"?(this.checked=!0,this.layer.map.setBaseLayer(this.layer,!0),this.layer.map.events.triggerEvent("changebaselayer")):(this.checked=!this.checked,this.control.updateMap())),OpenLayers.Event.stop(a)},onLayerClick:function(a){this.updateMap()},updateMap:function(){for(var a=0;a<this.baseLayerInputs.length;a++){var b=this.baseLayerInputs[a];b.checked&&this.map.setBaseLayer(b.layer,!1)}for(var a=0;a<this.dataLayerInputs.length;a++){var b=this.dataLayerInputs[a];b.layer.setVisibility(b.checked,!0)}},maximizeControl:function(a){this.div.style.width="20em",this.div.style.height="",this.showControls(!1),a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px",this.div.style.height="0px",this.showControls(!0),a!=null&&OpenLayers.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none",this.minimizeDiv.style.display=a?"none":"",this.layersDiv.style.display=a?"none":""},loadContents:function(){this.div.style.position="absolute",this.div.style.top="10px",this.div.style.right="0px",this.div.style.left="",this.div.style.fontFamily="sans-serif",this.div.style.fontWeight="bold",this.div.style.marginTop="3px",this.div.style.marginLeft="3px",this.div.style.marginBottom="3px",this.div.style.fontSize="smaller",this.div.style.color="white",this.div.style.backgroundColor="transparent",OpenLayers.Event.observe(this.div,"mouseup",this.mouseUp.bindAsEventListener(this)),OpenLayers.Event.observe(this.div,"click",this.ignoreEvent),OpenLayers.Event.observe(this.div,"mousedown",this.mouseDown.bindAsEventListener(this)),OpenLayers.Event.observe(this.div,"dblclick",this.ignoreEvent),this.layersDiv=document.createElement("div"),this.layersDiv.id="layersDiv",this.layersDiv.style.paddingTop="5px",this.layersDiv.style.paddingLeft="10px",this.layersDiv.style.paddingBottom="5px",this.layersDiv.style.paddingRight="75px",this.layersDiv.style.backgroundColor=this.activeColor,this.layersDiv.style.width="100%",this.layersDiv.style.height="100%";var a=document.createElement("div");a.innerHTML="<u>Base Layer</u>",a.style.marginTop="3px",a.style.marginLeft="3px",a.style.marginBottom="3px",this.baseLayersDiv=document.createElement("div"),this.baseLayersDiv.style.paddingLeft="10px",this.dataLbl=document.createElement("div"),this.dataLbl.innerHTML="<u>Overlays</u>",this.dataLbl.style.marginTop="3px",this.dataLbl.style.marginLeft="3px",this.dataLbl.style.marginBottom="3px",this.dataLayersDiv=document.createElement("div"),this.dataLayersDiv.style.paddingLeft="10px",this.ascending?(this.layersDiv.appendChild(a),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(a),this.layersDiv.appendChild(this.baseLayersDiv)),this.div.appendChild(this.layersDiv),Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.activeColor,blend:!1}),Rico.Corner.changeOpacity(this.layersDiv,.75);var b=OpenLayers.Util.getImagesLocation(),c=new OpenLayers.Size(18,18),d=b+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,c,d,"absolute"),this.maximizeDiv.style.top="5px",this.maximizeDiv.style.right="0px",this.maximizeDiv.style.left="",this.maximizeDiv.style.display="none",OpenLayers.Event.observe(this.maximizeDiv,"click",this.maximizeControl.bindAsEventListener(this)),this.div.appendChild(this.maximizeDiv);var d=b+"layer-switcher-minimize.png",c=new OpenLayers.Size(18,18);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,c,d,"absolute"),this.minimizeDiv.style.top="5px",this.minimizeDiv.style.right="0px",this.minimizeDiv.style.left="",this.minimizeDiv.style.display="none",OpenLayers.Event.observe(this.minimizeDiv,"click",this.minimizeControl.bindAsEventListener
(this)),this.div.appendChild(this.minimizeDiv)},ignoreEvent:function(a){OpenLayers.Event.stop(a)},mouseDown:function(a){this.mouseDown=!0,this.ignoreEvent(a)},mouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,this.ignoreEvent(a))},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"}),OpenLayers.Control.MouseDefaults=OpenLayers.Class.create(),OpenLayers.Control.MouseDefaults.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{performedDrag:!1,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),OpenLayers.Event.observe(window,"DOMMouseScroll",this.onWheelEvent.bindAsEventListener(this)),OpenLayers.Event.observe(window,"mousewheel",this.onWheelEvent.bindAsEventListener(this)),OpenLayers.Event.observe(document,"mousewheel",this.onWheelEvent.bindAsEventListener(this))},draw:function(){this.map.events.register("click",this,this.defaultClick),this.map.events.register("dblclick",this,this.defaultDblClick),this.map.events.register("mousedown",this,this.defaultMouseDown),this.map.events.register("mouseup",this,this.defaultMouseUp),this.map.events.register("mousemove",this,this.defaultMouseMove),this.map.events.register("mouseout",this,this.defaultMouseOut)},defaultClick:function(a){if(!OpenLayers.Event.isLeftClick(a))return;var b=!this.performedDrag;return this.performedDrag=!1,b},defaultDblClick:function(a){var b=this.map.getLonLatFromViewPortPx(a.xy);return this.map.setCenter(b,this.map.zoom+1),OpenLayers.Event.stop(a),!1},defaultMouseDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.mouseDragStart=a.xy.clone(),this.performedDrag=!1,a.shiftKey&&(this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox)),document.onselectstart=function(){return!1},OpenLayers.Event.stop(a)},defaultMouseMove:function(a){if(this.mouseDragStart!=null){if(this.zoomBox){var b=Math.abs(this.mouseDragStart.x-a.xy.x),c=Math.abs(this.mouseDragStart.y-a.xy.y);this.zoomBox.style.width=Math.max(1,b)+"px",this.zoomBox.style.height=Math.max(1,c)+"px",a.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=a.xy.x+"px"),a.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=a.xy.y+"px")}else{var b=this.mouseDragStart.x-a.xy.x,c=this.mouseDragStart.y-a.xy.y,d=this.map.getSize(),e=new OpenLayers.Pixel(d.w/2+b,d.h/2+c),f=this.map.getLonLatFromViewPortPx(e);this.map.setCenter(f,null,!0),this.mouseDragStart=a.xy.clone(),this.map.div.style.cursor="move"}this.performedDrag=!0}},defaultMouseUp:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.zoomBox?this.zoomBoxEnd(a):this.performedDrag&&this.map.setCenter(this.map.center),document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="default"},defaultMouseOut:function(a){this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)&&(this.zoomBox&&this.removeZoomBox(),this.mouseDragStart=null)},defaultWheelUp:function(){this.map.zoomIn()},defaultWheelDown:function(){this.map.zoomOut()},zoomBoxEnd:function(a){if(this.mouseDragStart!=null){if(Math.abs(this.mouseDragStart.x-a.xy.x)>5||Math.abs(this.mouseDragStart.y-a.xy.y)>5){var b=this.map.getLonLatFromViewPortPx(this.mouseDragStart),c=this.map.getLonLatFromViewPortPx(a.xy),d=Math.max(b.lat,c.lat),e=Math.min(b.lat,c.lat),f=Math.min(b.lon,c.lon),g=Math.max(b.lon,c.lon),h=new OpenLayers.Bounds(f,e,g,d);this.map.zoomToExtent(h)}else{var c=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(new OpenLayers.LonLat(c.lon,c.lat),this.map.getZoom()+1)}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null},onWheelEvent:function(a){var b=!1,c=OpenLayers.Event.element(a);while(c!=null){if(this.map&&c==this.map.div){b=!0;break}c=c.parentNode}if(b){var d=0;a||(a=window.event),a.wheelDelta?(d=a.wheelDelta/120,window.opera&&(d=-d)):a.detail&&(d=-a.detail/3),d&&(d<0?this.defaultWheelDown():this.defaultWheelUp()),OpenLayers.Event.stop(a)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"}),OpenLayers.Control.MousePosition=OpenLayers.Class.create(),OpenLayers.Control.MousePosition.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{element:null,prefix:"",separator:", ",suffix:"",numdigits:5,granularity:10,lastXy:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.left="",this.div.top="",this.div.className="olControlMousePosition",this.element=this.div),this.redraw(),this.div},redraw:function(a){var b;if(a==null)b=new OpenLayers.LonLat(0,0);else{if(this.lastXy==null||Math.abs(a.xy.x-this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity){this.lastXy=a.xy;return}b=this.map.getLonLatFromPixel(a.xy),this.lastXy=a.xy}var c=parseInt(this.numdigits),d=this.prefix+b.lon.toFixed(c)+this.separator+b.lat.toFixed(c)+this.suffix;d!=this.element.innerHTML&&(this.element.innerHTML=d)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("mousemove",this,this.redraw)},CLASS_NAME:"OpenLayers.Control.MousePosition"}),OpenLayers.Control.PanZoom=OpenLayers.Class.create(),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,OpenLayers.Control.PanZoom.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{slideFactor:50,buttons:null,position:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y)},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments),a=this.position,this.buttons=new Array;var b=new OpenLayers.Size(18,18),c=new OpenLayers.Pixel(a.x+b.w/2,a.y);return this._addButton("panup","north-mini.png",c,b),a.y=c.y+b.h,this._addButton("panleft","west-mini.png",a,b),this._addButton("panright","east-mini.png",a.add(b.w,0),b),this._addButton("pandown","south-mini.png",c.add(0,b.h*2),b),this._addButton("zoomin","zoom-plus-mini.png",c.add(0,b.h*3+5),b),this._addButton("zoomworld","zoom-world-mini.png",c.add(0,b.h*4+5),b),this._addButton("zoomout","zoom-minus-mini.png",c.add(0,b.h*5+5),b),this.div},_addButton:function(a,b,c,d){var e=OpenLayers.Util.getImagesLocation()+b,f=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_PanZoom_"+a,c,d,e,"absolute");return this.div.appendChild(f),f.onmousedown=this.buttonDown.bindAsEventListener(f),f.ondblclick=this.doubleClick.bindAsEventListener(f),f.onclick=this.doubleClick.bindAsEventListener(f),f.action=a,f.map=this.map,f.slideFactor=this.slideFactor,this.buttons.push(f),f},doubleClick:function(a){return OpenLayers.Event.stop(a),!1},buttonDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;switch(this.action){case"panup":this.map.pan(0,-50);break;case"pandown":this.map.pan(0,50);break;case"panleft":this.map.pan(-50,0);break;case"panright":this.map.pan(50,0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}OpenLayers.Event.stop(a)},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);for(i=0;i<this.buttons.length;i++)this.buttons[i].map=null},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.Permalink=OpenLayers.Class.create(),OpenLayers.Control.Permalink.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{element:null,base:"",initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.element=a,b&&(this.base=b)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0;b<this.map.controls.length;b++){var c=this.map.controls[b];if(c.CLASS_NAME=="OpenLayers.Control.ArgParser")break}b==this.map.controls.length&&this.map.addControl(new OpenLayers.Control.ArgParser)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.className="olControlPermalink",this.element=document.createElement("a"),this.element.style.fontSize="smaller",this.element.innerHTML="Permalink",this.element.href="",this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateLink),this.div},updateLink:function(){var a=this.map.getCenter(),b="zoom="+this.map.getZoom(),c="lat="+Math.round(a.lat*1e5)/1e5,d="lon="+Math.round(a.lon*1e5)/1e5,e="layers=";for(var f=0;f<this.map.layers.length;f++){var g=this.map.layers[f];g.isBaseLayer?e+=g==this.map.baseLayer?"B":"0":e+=g.getVisibility()?"T":"F"}var h=this.base+"?"+c+"&"+d+"&"+b+"&"+e;this.element.href=h},CLASS_NAME:"OpenLayers.Control.Permalink"}),OpenLayers.Control.Scale=OpenLayers.Class.create(),OpenLayers.Control.Scale.prototype=OpenLayers.Class.inherit(OpenLayers.Control,{element:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.element=a},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.element=document.createElement("div"),this.div.className="olControlScale",this.element.style.fontSize="smaller",this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateScale),this.updateScale(),this.div},updateScale:function(){var a=this.map.getScale();if(!a)return;a>=9500&&a<=95e4?a=Math.round(a/1e3)+"K":a>=95e4?a=Math.round(a/1e6)+"M":a=Math.round(a/100)*100,this.element.innerHTML="Scale = 1 : "+a},CLASS_NAME:"OpenLayers.Control.Scale"}),OpenLayers.Feature=OpenLayers.Class.create(),OpenLayers.Feature.prototype={events:null,layer:null,id:null,lonlat:null,data:null,marker:null,popup:null,initialize:function(a,b,c){this.layer=a,this.lonlat=b,this.data=c!=null?c:new Object,this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.layer!=null&&this.layer.map!=null&&this.popup!=null&&this.layer.map.removePopup(this.popup),this.events=null,this.layer=null,this.id=null,this.lonlat=null,this.data=null,this.marker!=null&&(this.destroyMarker(this.marker),this.marker=null),this.popup!=null&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;if(this.layer!=null&&this.layer.map!=null){var b=this.layer.map.getExtent();a=b.containsLonLat(this.lonlat)}return a},createMarker:function(){var a=null;return this.lonlat!=null&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(){if(this.lonlat!=null){var a=this.id+"_popup",b=this.marker?this.marker.icon:null;this.popup=new OpenLayers.Popup.AnchoredBubble(a,this.lonlat,this.data.popupSize,this.data.popupContentHTML,b)}return this.popup},destroyPopup:function(){this.popup.destroy()},CLASS_NAME:"OpenLayers.Feature"},OpenLayers.Layer.Canvas=OpenLayers.Class.create(),OpenLayers.Layer.Canvas.prototype=OpenLayers.Class.inherit(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!0,canvas:null,lines:new Array,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments)},destroy:function(){canvas=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments),this.redraw()},setStrokeColor:function(a){var b=this.canvas.getContext("2d");b.strokeStyle=a},setStrokeWidth:function(a){var b=this.canvas.getContext("2d");b.lineWidth=a},setAlpha:function(a){var b=this.canvas.getContext("2d");b.globalAlpha=a},clearCanvas:function(){this.canvas!=null&&this.canvas.getContext("2d").clearRect(0,0,this.map.getSize().w,this.map.getSize().h)},drawLine:function(a,b){var c=this.canvas.getContext("2d");this.addLine(a,b),this.lines.push(new Array(a,b,c.strokeStyle,c.lineWidth,c.globalAlpha))},addLine:function(a,b){var c=this.canvas.getContext("2d"),d=this.map.getPixelFromLonLat(a),e=this.map.getPixelFromLonLat(b);c.beginPath(),c.moveTo(d.x,d.y),c.lineTo(e.x,e.y),c.closePath(),c.stroke()},redraw:function(){this.canvas?this.clearCanvas():(this.canvas=document.createElement("CANVAS"),this.canvas.setAttribute("width",this.map.getSize().w),this.canvas.setAttribute("height",this.map.getSize().h),this.div.appendChild(this.canvas));for(var a=0;a<this.lines.length;a++)this.setStrokeColor(this.lines[a][2]),this.setStrokeWidth(this.lines[a][3]),this.setAlpha(this.lines[a][4]),this.addLine(this.lines[a][0],this.lines[a][1])},CLASS_NAME:"OpenLayers.Layer.Canvas"}),OpenLayers.Layer.EventPane=OpenLayers.Class.create(),OpenLayers.Layer.EventPane.prototype=OpenLayers.Class.inherit(OpenLayers.Layer,{isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.pane==null&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.mapObject=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1,this.pane.style.display=this.div.style.display,this.pane.style.width="100%",this.pane.style.height="100%",/MSIE/.test(navigator.userAgent)&&(this.pane.style.background="url("+OpenLayers.Util.getImagesLocation()+"blank.gif)"),this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane),this.loadMapObject(),this.mapObject==null&&this.loadWarningMessage()},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize();msgW=Math.min(a.w,300),msgH=Math.min(a.h,200);var b=new OpenLayers.Size(msgW,msgH),c=new OpenLayers.Pixel(a.w/2,a.h/2),d=c.add(-b.w/2,-b.h/2),e=OpenLayers.Util.createDiv(this.name+"_warning",d,b,null,null,null,"auto");e.style.padding="7px",e.style.backgroundColor="yellow",e.innerHTML=this.getWarningHTML(),this.div.appendChild(e)},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments),this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var d=this.map.getCenter(),e=this.map.getZoom();if(d!=null){var f=this.getMapObjectCenter(),g=this.getOLLonLatFromMapObjectLonLat(f),h=this.getMapObjectZoom(),i=this.getOLZoomFromMapObjectZoom(h);if(!d.equals(g)||e!=i){var j=this.getMapObjectLonLatFromOLLonLat(d),k=this.getMapObjectZoomFromOLZoom(e);this.setMapObjectCenter(j,k)}}}},getLonLatFromViewPortPx:function(a){var b=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var c=this.getMapObjectPixelFromOLPixel(a),d=this.getMapObjectLonLatFromMapObjectPixel(c);b=this.getOLLonLatFromMapObjectLonLat(d)}return b},getViewPortPxFromLonLat:function(a){var b=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var c=this.getMapObjectLonLatFromOLLonLat(a),d=this.getMapObjectPixelFromMapObjectLonLat(c);b=this.getOLPixelFromMapObjectPixel(d)}return b},getOLLonLatFromMapObjectLonLat:function(a){var b=null;if(a!=null){var c=this.getLongitudeFromMapObjectLonLat(a),d=this.getLatitudeFromMapObjectLonLat(a);b=new OpenLayers.LonLat(c,d)}return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;return a!=null&&(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat)),b},getOLPixelFromMapObjectPixel:function(a){var b=null;if(a!=null){var c=this.getXFromMapObjectPixel(a),d=this.getYFromMapObjectPixel(a);b=new OpenLayers.Pixel(c,d)}return b},getMapObjectPixelFromOLPixel:function(a){var b=null;return a!=null&&(b=this.getMapObjectPixelFromXY(a.x,a.y)),b},CLASS_NAME:"OpenLayers.Layer.EventPane"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class.create(),OpenLayers.Layer.HTTPRequest.prototype=OpenLayers.Class.inherit(OpenLayers.Layer,{url:null,params:null,reproject:!1,initialize:function(a,b,c,d){var e=arguments;e=[a,d],OpenLayers.Layer.prototype.initialize.apply(this,e),this.url=b,this.params=OpenLayers.Util.extend(new Object,c)},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.options)),a=OpenLayers.Layer.prototype.clone.apply(this,[a]),a},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a)},getFullRequestString:function(a,b){var c=b==null?this.url:b,d=c,e=OpenLayers.Util.extend(new Object,this.params),e=OpenLayers.Util.extend(e,a),f=OpenLayers.Util.getParameterString(e);if(f!=""){var g=this.url.charAt(this.url.length-1);g=="&"||g=="?"?d+=f:this.url.indexOf("?")==-1?d+="?"+f:d+="&"+f}return d},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Layer.Image=OpenLayers.Class.create(),OpenLayers.Layer.Image.prototype=OpenLayers.Class.inherit(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b,this.extent=c,this.size=d,OpenLayers.Layer.prototype.initialize.apply(this,[a,e]),this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile.destroy(),this.tile=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.options)),a=OpenLayers.Layer.prototype.clone.apply(this,[a]),a},setMap:function(a){this.options.maxResolution==null&&(this.options.maxResolution=this.extent.getWidth()/this.size.w),OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=this.tile==null;if(b||d){var e=this.extent.getWidth()/this.map.getResolution(),f=this.extent.getHeight()/(this.map.getResolution()*this.aspectRatio),g=new OpenLayers.Size(e,f),h=new OpenLayers.LonLat(this.extent.left,this.extent.top),i=this.map.getLayerPxFromLonLat(h);d?this.tile=new OpenLayers.Tile.Image(this,i,this.extent,this.url,g):(this.tile.size=g.clone(),this.tile.position=i.clone()),this.tile.draw()}},setUrl:function(a){this.url=a,this.draw()},getURL:function(a){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"}),OpenLayers.Layer.Markers=OpenLayers.Class.create(),OpenLayers.Layer.Markers.prototype=OpenLayers.Class.inherit(OpenLayers.Layer,{isBaseLayer:!1,markers:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=new Array},destroy:function(){this.clearMarkers(),markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments),b&&this.redraw()},addMarker:function(a){this.markers.push(a),this.map&&this.map.getExtent()&&(a.map=this.map,this.drawMarker(a))},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a),a.icon!=null&&a.icon.imageDiv!=null&&a.icon.imageDiv.parentNode==this.div&&this.div.removeChild(a.icon.imageDiv)},clearMarkers:function(){if(this.markers!=null)while(this.markers.length>0)this.removeMarker(this.markers[0])},redraw:function(){for(i=0;i<this.markers.length;i++)this.drawMarker(this.markers[i])},drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);if(b==null)a.display(!1);else{var c=a.draw(b);a.drawn||(this.div.appendChild(c),a.drawn=!0)}},CLASS_NAME:"OpenLayers.Layer.Markers"}),OpenLayers.Map=OpenLayers.Class.create(),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Map.prototype={Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Popup:750,Control:1e3},EVENT_TYPES:["addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer"],events:null,div:null,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,zoom:0,tileSize:null,projection:"EPSG:4326",units:"degrees",maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,numZoomLevels:16,theme:null,initialize:function(a,b){this.div=a=$(a);var c=a.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),c=a.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(c),this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.viewPortDiv.appendChild(this.layerContainerDiv),this.events=new OpenLayers.Events(this,a,this.EVENT_TYPES),this.updateSize(),navigator.appName.contains("Microsoft")?this.events.register("resize",this,this.updateSize):OpenLayers.Event.observe(window,"resize",this.updateSize.bindAsEventListener(this)),this.setOptions(b);var d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(d),this.layers=[],this.controls==null&&(OpenLayers.Control!=null?this.controls=[new OpenLayers.Control.MouseDefaults,new OpenLayers.Control.PanZoom,new OpenLayers.Control.ArgParser]:this.controls=[]);for(var e=0;e<this.controls.length;e++)this.addControlToMap(this.controls[e]);this.popups=new Array,OpenLayers.Event.observe(window,"unload",this.destroy.bindAsEventListener(this))},destroy:function(){if(this.layers!=null){for(var a=0;a<this.layers.length;a++)this.layers[a].destroy();this.layers=null}if(this.controls!=null){for(var a=0;a<this.controls.length;a++)this.controls[a].destroy();this.controls=null}},setOptions:function(a){this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",OpenLayers.Util.extend(this,a)},getTileSize:function(){return this.tileSize},getLayer:function(a){var b=null;for(var c=0;c<this.layers.length;c++){var d=this.layers[c];d.id==a&&(b=d)}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+b*5)},addLayer:function(a){a.div.style.overflow="",this.setLayerZIndex(a,this.layers.length),a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div),this.layers.push(a),a.setMap(this),a.isBaseLayer?this.baseLayer==null?this.setBaseLayer(a):a.setVisibility(!1):this.getCenter()!=null&&a.moveTo(this.getExtent(),!0),this.events.triggerEvent("addlayer")},addLayers:function(a){for(var b=0;b<a.length;b++)this.addLayer(a[b])},removeLayer:function(a){a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div),a.map=null,OpenLayers.Util.removeItem(this.layers,a);if(this.baseLayer==a){this.baseLayer=null;for(i=0;i<this.layers.length;i++){var b=this.layers[i];if(b.isBaseLayer){this.setBaseLayer(b);break}}}this.events.triggerEvent("removelayer")},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);b<0?b=0:b>this.layers.length&&(b=this.layers.length);if(c!=b){this.layers.splice(c,1),this.layers.splice(b,0,a);for(var d=0;d<this.layers.length;d++)this.setLayerZIndex(this.layers[d],d);this.events.triggerEvent("changelayer")}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a,b){var c=this.baseLayer;if(a!=c&&OpenLayers.Util.indexOf(this.layers,a)!=-1){c!=null&&c.setVisibility(!1,b),this.baseLayer=a,this.baseLayer.setVisibility(!0,b);var d=this.getCenter();d!=null&&(c==null?this.setCenter(d):this.zoomToExtent(c.getExtent())),(b==null||b==0)&&this.events.triggerEvent("changebaselayer")}},addControl:function(a,b){this.controls.push(a),this.addControlToMap(a,b)},addControlToMap:function(a,b){a.setMap(this);var c=a.draw(b);c&&(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c))},addPopup:function(a,b){if(b)for(var c=0;c<this.popups.length;c++)this.removePopup(this.popups[c]);a.map=this,this.popups.push(a);var d=a.draw();d&&(d.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(d))},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;return this.size!=null&&(a=this.size.clone()),a},updateSize:function(){var a=this.getCurrentSize(),b=this.getSize();b==null&&(this.size=b=a);if(!a.equals(b)){for(var c=0;c<this.layers.length;c++)this.layers[c].onMapResize();this.size=a,this.events.element.offsets=null;if(this.baseLayer!=null){var d=new OpenLayers.Pixel(a.w/2,a.h/2),e=this.getLonLatFromViewPortPx(d),f=this.getZoom();this.zoom=null,this.setCenter(this.getCenter(),f)}}},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(a.w==0&&a.h==0){var b=OpenLayers.Element.getDimensions(this.div);a.w=b.width,a.h=b.height}return a.w==0&&a.h==0&&(a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height)),a},calculateBounds:function(a,b){var c=null;a==null&&(a=this.getCenter()),b==null&&(b=this.getResolution());if(a!=null&&b!=null){var d=this.getSize(),e=d.w*b,f=d.h*b;c=new OpenLayers.Bounds(a.lon-e/2,a.lat-f/2,a.lon+e/2,a.lat+f/2)}return c},getCenter:function(){return this.center},getZoom:function(){return this.zoom},pan:function(a,b){var c=this.getViewPortPxFromLonLat(this.getCenter()),d=c.add(a,b);if(!d.equals(c)){var e=this.getLonLatFromViewPortPx(d);this.setCenter(e)}},setCenter:function(a,b,c){!this.center&&!this.isValidLonLat(a)&&(a=this.maxExtent.getCenterLonLat());var d=this.isValidZoomLevel(b)&&b!=this.getZoom(),e=this.isValidLonLat(a)&&!a.equals(this.center);if(d||e||!c){c||this.events.triggerEvent("movestart"),e&&(!d&&this.center&&this.centerLayerContainer(a),this.center=a.clone());if(d||this.layerContainerOrigin==null)this.layerContainerOrigin=this.center.clone(),this.layerContainerDiv.style.left="0px",this.layerContainerDiv.style.top="0px";if(d){this.zoom=b;for(var f=0;f<this.popups.length;f++)this.popups[f].updatePosition()}var g=this.getExtent();this.baseLayer.moveTo(g,d,c);for(var f=0;f<this.layers.length;f++){var h=this.layers[f];if(!h.isBaseLayer){var i,j=h.calculateInRange();h.inRange!=j?(h.inRange=j,i=!0,this.events.triggerEvent("changelayer")):i=h.visibility&&h.inRange,i&&h.moveTo(g,d,c)}}this.events.triggerEvent("move"),d&&this.events.triggerEvent("zoomend")}c||this.events.triggerEvent("moveend")},centerLayerContainer:function(a){var b=this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);b!=null&&c!=null&&(this.layerContainerDiv.style.left=b.x-c.x+"px",this.layerContainerDiv.style.top=b.y-c.y+"px")},isValidZoomLevel:function(a){return a!=null&&a>=0&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;if(a!=null){var c=this.getMaxExtent();b=c.containsLonLat(a)}return b},getProjection:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.projection),a},getMaxResolution:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.maxResolution),a},getMaxExtent:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.maxExtent),a},getNumZoomLevels:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.numZoomLevels),a},getExtent:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.getExtent()),a},getResolution:function(){var a=null;return this.baseLayer!=null&&(a=this.baseLayer.getResolution()),a},getScale:function(){var a=null;if(this.baseLayer!=null){var b=this.getResolution(),c=this.baseLayer.units;a=OpenLayers.Util.getScaleFromResolution(b,c)}return a},getZoomForExtent:function(a){var b=null;return this.baseLayer!=null&&(b=this.baseLayer.getZoomForExtent(a)),b},getZoomForResolution:function(a){var b=null;return this.baseLayer!=null&&(b=this.baseLayer.getZoomForResolution(a)),b},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a){this.setCenter(a.getCenterLonLat(),this.getZoomForExtent(a))},zoomToMaxExtent:function(){this.zoomToExtent(this.getMaxExtent())},zoomToScale:function(a){var b=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),c=this.getSize(),d=c.w*b,e=c.h*b,f=this.getCenter(),g=new OpenLayers.Bounds(f.lon-d/2,f.lat-e/2,f.lon+d/2,f.lat+e/2);this.zoomToExtent(g)},getLonLatFromViewPortPx:function(a){var b=null;return this.baseLayer!=null&&(b=this.baseLayer.getLonLatFromViewPortPx(a)),b},getViewPortPxFromLonLat:function(a){var b=null;return this.baseLayer!=null&&(b=this.baseLayer.getViewPortPxFromLonLat(a)),b},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){return this.getViewPortPxFromLonLat(a)},getViewPortPxFromLayerPx:function(a){var b=null;if(a!=null){var c=parseInt(this.layerContainerDiv.style.left),d=parseInt(this.layerContainerDiv.style.top);b=a.add(c,d)}return b},getLayerPxFromViewPortPx:function(a){var b=null;if(a!=null){var c=-parseInt(this.layerContainerDiv.style.left),d=-parseInt(this.layerContainerDiv.style.top);b=a.add(c,d);if(isNaN(b.x)||isNaN(b.y))b=null}return b},getLonLatFromLayerPx:function(a){return a=this.getViewPortPxFromLayerPx(a),this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){var b=this.getViewPortPxFromLonLat(a);return this.getLayerPxFromViewPortPx(b)},CLASS_NAME:"OpenLayers.Map"},OpenLayers.Marker.Box=OpenLayers.Class.create(),OpenLayers.Marker.Box.prototype=OpenLayers.Class.inherit(OpenLayers.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a,this.div=OpenLayers.Util.createDiv(),this.div.style.overflow="hidden",this.events=new OpenLayers.Events(this,this.div,null),this.setBorder(b,c)},setBorder:function(a,b){a||(a="red"),b||(b=2),this.div.style.border=b+"px solid "+a},draw:function(a,b){return OpenLayers.Util.modifyDOMElement(this.div,null,a,b),this.div},onScreen:function(){var a=!1;if(this.map){var b=this.map.getExtent();a=b.containsBounds(this.bounds,!0,!0)}return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"}),OpenLayers.Popup.Anchored=OpenLayers.Class.create(),OpenLayers.Popup.Anchored.prototype=OpenLayers.Class.inherit(OpenLayers.Popup,{relativePosition:null,anchor:null,initialize:function(a,b,c,d,e,f){var g=new Array(a,b,c,d,f);OpenLayers.Popup.prototype.initialize.apply(this,g),this.anchor=e!=null?e:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},draw:function(a){return a==null&&this.lonlat!=null&&this.map!=null&&(a=this.map.getLayerPxFromLonLat(this.lonlat)),this.relativePosition=this.calculateRelativePosition(a),OpenLayers.Popup.prototype.draw.apply(this,arguments)},calculateRelativePosition:function(a){var b=this.map.getLonLatFromLayerPx(a),c=this.map.getExtent(),d=c.determineQuadrant(b);return OpenLayers.Bounds.oppositeQuadrant(d)},moveTo:function(a){var b=this.calculateNewPx(a),c=new Array(b);OpenLayers.Popup.prototype.moveTo.apply(this,c)},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if(this.lonlat&&this.map){var b=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(b)}},calculateNewPx:function(a){var b=a.offset(this.anchor.offset),c=this.relativePosition.charAt(0)=="t";b.y+=c?-this.size.h:this.anchor.size.h;var d=this.relativePosition.charAt(1)=="l";return b.x+=d?-this.size.w:this.anchor.size.w,b},CLASS_NAME:"OpenLayers.Popup.Anchored"}),OpenLayers.Tile.Image=OpenLayers.Class.create(),OpenLayers.Tile.Image.prototype=OpenLayers.Class.inherit(OpenLayers.Tile,{imgDiv:null,initialize:function(a,b,c,d,e){OpenLayers.Tile.prototype.initialize.apply(this,arguments)},destroy:function(){this.imgDiv!=null&&this.imgDiv.parentNode==this.layer.div&&this.layer.div.removeChild(this.imgDiv),this.imgDiv=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Tile.prototype.draw.apply(this,arguments),this.imgDiv==null&&this.initImgDiv(),this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.url=this.layer.getURL(this.bounds),this.imgDiv.style.display="none";if(this.layer.displayOutsideMaxExtent||this.layer.maxExtent&&this.bounds.intersectsBounds(this.
layer.maxExtent,!1))this.layer.alpha?OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,this.position,this.size,this.url):(this.imgDiv.src=this.url,OpenLayers.Util.modifyDOMElement(this.imgDiv,null,this.position,this.size))},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments),this.imgDiv&&(this.imgDiv.style.display="none")},moveTo:function(a,b,c){this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(a=this.getBoundsFromBaseLayer(b)),this.url=this.layer.getURL(a),OpenLayers.Tile.prototype.moveTo.apply(this,arguments)},initImgDiv:function(){this.layer.alpha?this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,this.position,this.size,null,"absolute",null,null,null,!0):this.imgDiv=OpenLayers.Util.createImage(null,this.position,this.size,null,"absolute",null,null,!0),this.imgDiv.className="olTileImage",OpenLayers.Event.observe(this.imgDiv,"load",this.checkImgURL.bindAsEventListener(this)),this.layer.div.appendChild(this.imgDiv),this.layer.opacity!=null&&OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)},checkImgURL:function(){var a=this.layer.alpha?this.imgDiv.firstChild.src:this.imgDiv.src;a!=this.url&&(this.imgDiv.style.display="none")},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Tile.WFS=OpenLayers.Class.create(),OpenLayers.Tile.WFS.prototype=OpenLayers.Class.inherit(OpenLayers.Tile,{features:null,urls:null,initialize:function(a,b,c,d,e){var f=arguments;f=[a,b,c,null,e],OpenLayers.Tile.prototype.initialize.apply(this,f),this.urls=d,this.features=new Array},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments),this.destroyAllFeatures(),this.features=null,this.urls=null},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments),this.destroyAllFeatures()},draw:function(){this.drawn&&this.clear(),OpenLayers.Tile.prototype.draw.apply(this,arguments),(this.layer.displayOutsideMaxExtent||this.layer.maxExtent&&this.layer.maxExtent.intersectsBounds(this.bounds,!1))&&this.loadFeaturesForRegion(this.requestSuccess)},loadFeaturesForRegion:function(a,b){if(this.urls!=null)for(var c=0;c<this.urls.length;c++){var d={BBOX:this.bounds.toBBOX()},e=this.urls[c]+"&"+OpenLayers.Util.getParameterString(d);OpenLayers.loadURL(e,null,this,a,b)}},requestSuccess:function(a){var b=a.responseXML;if(!b||a.fileType!="XML")b=OpenLayers.parseXMLString(a.responseText);var c=OpenLayers.Ajax.getElementsByTagNameNS(b,"http://www.opengis.net/gml","gml","featureMember");this.addResults(c)},addResults:function(a){for(var b=0;b<a.length;b++){var c=new this.layer.featureClass(this.layer,a[b]);this.features.push(c)}},destroyAllFeatures:function(){while(this.features.length>0){var a=this.features.shift();a.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"}),OpenLayers.Control.MouseToolbar=OpenLayers.Class.create(),OpenLayers.Control.MouseToolbar.X=6,OpenLayers.Control.MouseToolbar.Y=300,OpenLayers.Control.MouseToolbar.prototype=OpenLayers.Class.inherit(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y),a&&(this.position=a),b&&(this.direction=b),this.measureDivs=[]},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments),this.buttons=new Object;var a=new OpenLayers.Size(28,28),b=this.position;return this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",b,a,"Shift->Drag to zoom to area"),b=b.add(this.direction=="vertical"?0:a.w,this.direction=="vertical"?a.h:0),this._addButton("pan","panning-hand-off.png","panning-hand-on.png",b,a,"Drag the map to pan."),b=b.add(this.direction=="vertical"?0:a.w,this.direction=="vertical"?a.h:0),this.switchModeTo("pan"),this.div},_addButton:function(a,b,c,d,e,f){var g=OpenLayers.Util.getImagesLocation()+b,h=OpenLayers.Util.getImagesLocation()+c,i=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+a,d,e,g,"absolute");return this.div.appendChild(i),i.imgLocation=g,i.activeImgLocation=h,i.events=new OpenLayers.Events(this,i,null,!0),i.events.register("mousedown",this,this.buttonDown),i.events.register("mouseup",this,this.buttonUp),i.events.register("dblclick",this,OpenLayers.Event.stop),i.action=a,i.title=f,i.alt=f,i.map=this.map,this.buttons[a]=i,i},buttonDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.buttonClicked=a.element.action,OpenLayers.Event.stop(a)},buttonUp:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.buttonClicked!=null&&(this.buttonClicked==a.element.action&&this.switchModeTo(a.element.action),OpenLayers.Event.stop(a),this.buttonClicked=null)},defaultDblClick:function(a){this.switchModeTo("pan"),this.performedDrag=!1;var b=this.map.getLonLatFromViewPortPx(a.xy);return this.map.setCenter(b,this.map.zoom+1),OpenLayers.Event.stop(a),!1},defaultMouseDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.mouseDragStart=a.xy.clone(),this.performedDrag=!1,this.startViaKeyboard=!1,a.shiftKey&&this.mode!="zoombox"?(this.switchModeTo("zoombox"),this.startViaKeyboard=!0):a.altKey&&this.mode!="measure"?this.switchModeTo("measure"):this.mode||this.switchModeTo("pan");switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),this.performedDrag=!0;break;case"measure":var b="";this.measureStart&&(measureEnd=this.map.getLonLatFromViewPortPx(this.mouseDragStart),b=OpenLayers.Util.distVincenty(this.measureStart,measureEnd),b=Math.round(b*100)/100,b+="km",this.measureStartBox=this.measureBox),this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart),this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBox.style.width="4px",this.measureBox.style.height="4px",this.measureBox.style.fontSize="1px",this.measureBox.style.backgroundColor="red",this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),b&&(this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBoxDistance.innerHTML=b,this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBoxDistance),this.measureDivs.push(this.measureBoxDistance)),this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move"}document.onselectstart=function(){return!1},OpenLayers.Event.stop(a)},switchModeTo:function(a){if(a!=this.mode){this.mode&&this.buttons[this.mode]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation);if(this.mode=="measure"&&a!="measure"){for(var b=0;b<this.measureDivs.length;b++)this.measureDivs[b]&&this.map.layerContainerDiv.removeChild(this.measureDivs[b]);this.measureDivs=[],this.measureStart=null}this.mode=a,this.buttons[a]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[a],null,null,null,this.buttons[a].activeImgLocation);switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor="default"}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(a){if(this.mouseDragStart!=null){switch(this.mode){case"zoombox":var b=Math.abs(this.mouseDragStart.x-a.xy.x),c=Math.abs(this.mouseDragStart.y-a.xy.y);this.zoomBox.style.width=Math.max(1,b)+"px",this.zoomBox.style.height=Math.max(1,c)+"px",a.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=a.xy.x+"px"),a.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=a.xy.y+"px");break;default:var b=this.mouseDragStart.x-a.xy.x,c=this.mouseDragStart.y-a.xy.y,d=this.map.getSize(),e=new OpenLayers.Pixel(d.w/2+b,d.h/2+c),f=this.map.getLonLatFromViewPortPx(e);this.map.setCenter(f,null,!0),this.mouseDragStart=a.xy.clone()}this.performedDrag=!0}},defaultMouseUp:function(a){if(!OpenLayers.Event.isLeftClick(a))return;switch(this.mode){case"zoombox":this.zoomBoxEnd(a),this.startViaKeyboard&&this.leaveMode();break;case"pan":this.performedDrag&&this.map.setCenter(this.map.center)}document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="default"},defaultMouseOut:function(a){this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)&&(this.zoomBox&&(this.removeZoomBox(),this.startViaKeyboard&&this.leaveMode()),this.mouseDragStart=null,this.map.div.style.cursor="default")},defaultClick:function(a){if(this.performedDrag)return this.performedDrag=!1,!1}}),OpenLayers.Control.PanZoomBar=OpenLayers.Class.create(),OpenLayers.Control.PanZoomBar.X=4,OpenLayers.Control.PanZoomBar.Y=4,OpenLayers.Control.PanZoomBar.prototype=OpenLayers.Class.inherit(OpenLayers.Control.PanZoom,{buttons:null,zoomStopWidth:18,zoomStopHeight:11,initialize:function(){OpenLayers.Control.PanZoom.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoomBar.X,OpenLayers.Control.PanZoomBar.Y)},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments),this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){this.div!=null&&(this.div.innerHTML=""),this.draw()},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments),a=this.position.clone(),this.buttons=new Array;var b=new OpenLayers.Size(18,18),c=new OpenLayers.Pixel(a.x+b.w/2,a.y);return this._addButton("panup","north-mini.png",c,b),a.y=c.y+b.h,this._addButton("panleft","west-mini.png",a,b),this._addButton("panright","east-mini.png",a.add(b.w,0),b),this._addButton("pandown","south-mini.png",c.add(0,b.h*2),b),this._addButton("zoomin","zoom-plus-mini.png",c.add(0,b.h*3+5),b),c=this._addZoomBar(c.add(0,b.h*4+5)),this._addButton("zoomout","zoom-minus-mini.png",c,b),this.div},_addZoomBar:function(a){var b=OpenLayers.Util.getImagesLocation(),c="OpenLayers_Control_PanZoomBar_Slider"+this.map.id,d=this.map.getNumZoomLevels()-1-this.map.getZoom(),e=OpenLayers.Util.createAlphaImageDiv(c,a.add(-1,d*this.zoomStopHeight),new OpenLayers.Size(20,9),b+"slider.png","absolute");this.slider=e,this.sliderEvents=new OpenLayers.Events(this,e,null,!0),this.sliderEvents.register("mousedown",this,this.zoomBarDown),this.sliderEvents.register("mousemove",this,this.zoomBarDrag),this.sliderEvents.register("mouseup",this,this.zoomBarUp),this.sliderEvents.register("dblclick",this,this.doubleClick),this.sliderEvents.register("click",this,this.doubleClick),sz=new OpenLayers.Size,sz.h=this.zoomStopHeight*this.map.getNumZoomLevels(),sz.w=this.zoomStopWidth;var f=null;if(OpenLayers.Util.alphaHack()){var c="OpenLayers_Control_PanZoomBar"+this.map.id;f=OpenLayers.Util.createAlphaImageDiv(c,a,new OpenLayers.Size(sz.w,this.zoomStopHeight),b+"zoombar.png","absolute",null,"crop"),f.style.height=sz.h}else f=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,a,sz,b+"zoombar.png");return this.zoombarDiv=f,this.divEvents=new OpenLayers.Events(this,f,null,!0),this.divEvents.register("mousedown",this,this.divClick),this.divEvents.register("mousemove",this,this.passEventToSlider),this.divEvents.register("dblclick",this,this.doubleClick),this.divEvents.register("click",this,this.doubleClick),this.div.appendChild(f),this.startTop=parseInt(f.style.top),this.div.appendChild(e),this.map.events.register("zoomend",this,this.moveZoomBar),a=a.add(0,this.zoomStopHeight*this.map.getNumZoomLevels()),a},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},divClick:function(a){if(!OpenLayers.Event.isLeftClick(a))return;var b=a.xy.y,c=OpenLayers.Util.pagePosition(a.object)[1],d=Math.floor((b-c)/this.zoomStopHeight);this.map.zoomTo(this.map.getNumZoomLevels()-1-d),OpenLayers.Event.stop(a)},zoomBarDown:function(a){if(!OpenLayers.Event.isLeftClick(a))return;this.map.events.register("mousemove",this,this.passEventToSlider),this.map.events.register("mouseup",this,this.passEventToSlider),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor="move",OpenLayers.Event.stop(a)},zoomBarDrag:function(a){if(this.mouseDragStart!=null){var b=this.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(this.zoombarDiv);if(a.clientY-c[1]>0&&a.clientY-c[1]<parseInt(this.zoombarDiv.style.height)-2){var d=parseInt(this.slider.style.top)-b;this.slider.style.top=d+"px"}this.mouseDragStart=a.xy.clone(),OpenLayers.Event.stop(a)}},zoomBarUp:function(a){if(!OpenLayers.Event.isLeftClick(a))return;if(this.zoomStart){this.div.style.cursor="default",this.map.events.unregister("mouseup",this,this.passEventToSlider),this.map.events.unregister("mousemove",this,this.passEventToSlider);var b=this.zoomStart.y-a.xy.y;this.map.zoomTo(this.map.zoom+Math.round(b/this.zoomStopHeight)),this.moveZoomBar(),this.mouseDragStart=null,OpenLayers.Event.stop(a)}},moveZoomBar:function(){var a=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=a+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"}),OpenLayers.Feature.WFS=OpenLayers.Class.create(),OpenLayers.Feature.WFS.prototype=OpenLayers.Class.inherit(OpenLayers.Feature,{initialize:function(a,b){var c=arguments,d=this.processXMLNode(b);c=new Array(a,d.lonlat,d),OpenLayers.Feature.prototype.initialize.apply(this,c),this.createMarker(),this.layer.addMarker(this.marker)},destroy:function(){this.marker!=null&&this.layer.removeMarker(this.marker),OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(a){var b=OpenLayers.Ajax.getElementsByTagNameNS(a,"http://www.opengis.net/gml","gml","Point"),c=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(b[0],"http://www.opengis.net/gml","gml","coordinates")[0]),d=c.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(d[0]),parseFloat(d[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"}),OpenLayers.Layer.Boxes=OpenLayers.Class.create(),OpenLayers.Layer.Boxes.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Markers,{initialize:function(){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments)},drawMarker:function(a){var b=a.bounds,c=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(b.left,b.top)),d=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(b.right,b.bottom));if(d==null||c==null)a.display(!1);else{var e=new OpenLayers.Size(Math.max(1,d.x-c.x),Math.max(1,d.y-c.y)),f=a.draw(c,e);a.drawn||(this.div.appendChild(f),a.drawn=!0)}},CLASS_NAME:"OpenLayers.Layer.Boxes"}),OpenLayers.Layer.GeoRSS=OpenLayers.Class.create(),OpenLayers.Layer.GeoRSS.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Markers,{location:null,features:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[a]),this.location=b,this.features=new Array,OpenLayers.loadURL(b,null,this,this.parseData)},destroy:function(){this.clearFeatures(),this.features=null,OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments)},parseData:function(a){var b=a.responseXML;if(!b||a.fileType!="XML")b=OpenLayers.parseXMLString(a.responseText);this.name=null;try{this.name=b.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(c){this.name=b.getElementsByTagName("title")[0].firstChild.nodeValue}var d=null;try{d=b.getElementsByTagNameNS("*","item")}catch(c){d=b.getElementsByTagName("item")}if(d.length==0)try{d=b.getElementsByTagNameNS("*","entry")}catch(c){d=b.getElementsByTagName("entry")}for(var e=0;e<d.length;e++){var f={},g=OpenLayers.Util.getNodes(d[e],"georss:point"),h=OpenLayers.Util.getNodes(d[e],"geo:lat"),i=OpenLayers.Util.getNodes(d[e],"geo:long");if(g.length>0){var j=g[0].firstChild.nodeValue.split(" ");if(j.length!=2)var j=g[0].firstChild.nodeValue.split(",")}else{if(!(h.length>0&&i.length>0))continue;var j=[parseFloat(h[0].firstChild.nodeValue),parseFloat(i[0].firstChild.nodeValue)]}j=new OpenLayers.LonLat(parseFloat(j[1]),parseFloat(j[0]));var k="Untitled";try{k=OpenLayers.Util.getNodes(d[e],"title")[0].firstChild.nodeValue}catch(c){k="Untitled"}var l=null;try{l=d[e].getElementsByTagNameNS("*","description")}catch(c){l=d[e].getElementsByTagName("description")}if(l.length==0)try{l=d[e].getElementsByTagNameNS("*","summary")}catch(c){l=d[e].getElementsByTagName("summary")}var m="No description.";try{m=l[0].firstChild.nodeValue}catch(c){m="No description."}try{var n=OpenLayers.Util.getNodes(d[e],"link")[0].firstChild.nodeValue}catch(c){}f.icon=OpenLayers.Marker.defaultIcon(),f.popupSize=new OpenLayers.Size(250,120),k!=null&&m!=null&&(contentHTML='<div class="olLayerGeoRSSClose">[x]</div>',contentHTML+='<div class="olLayerGeoRSSTitle">',n&&(contentHTML+='<a class="link" href="'+n+'" target="_blank">'),contentHTML+=k,n&&(contentHTML+="</a>"),contentHTML+="</div>",contentHTML+='<div style="" class="olLayerGeoRSSDescription">',contentHTML+=m,contentHTML+="</div>",f.popupContentHTML=contentHTML);var o=new OpenLayers.Feature(this,j,f);this.features.push(o);var p=o.createMarker();p.events.register("click",o,this.markerClick),this.addMarker(p)}},markerClick:function(a){sameMarkerClicked=this==this.layer.selectedFeature,this.layer.selectedFeature=sameMarkerClicked?null:this;for(var b=0;b<this.layer.map.popups.length;b++)this.layer.map.removePopup(this.layer.map.popups[b]);if(!sameMarkerClicked){var c=this.createPopup();OpenLayers.Event.observe(c.div,"click",function(){for(var a=0;a<this.layer.map.popups.length;a++)this.layer.map.removePopup(this.layer.map.popups[a])}.bindAsEventListener(this)),this.layer.map.addPopup(c)}OpenLayers.Event.stop(a)},clearFeatures:function(){if(this.features!=null)while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a),a.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"}),OpenLayers.Layer.Google=OpenLayers.Class.create(),OpenLayers.Layer.Google.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20],type:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.addContainerPxFunction()},loadMapObject:function(){try{this.mapObject=new GMap2(this.div);var a=this.div.lastChild;this.div.removeChild(a),this.pane.appendChild(a),a.className="olLayerGooglePoweredBy gmnoprint",a.style.left="",a.style.bottom="";var b=this.div.lastChild;this.div.removeChild(b),this.pane.appendChild(b),b.className="olLayerGoogleCopyright",b.style.right="",b.style.bottom=""}catch(c){}},setMap:function(a){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments),this.type!=null&&this.map.events.register("moveend",this,this.setMapType)},setMapType:function(){this.mapObject.getCenter()!=null&&(this.mapObject.setMapType(this.type),this.map.events.unregister("moveend",this,this.setMapType))},onMapResize:function(){this.mapObject.checkResize()},getOLBoundsFromMapObjectBounds:function(a){var b=null;if(a!=null){var c=a.getSouthWest(),d=a.getNorthEast();b=new OpenLayers.Bounds(c.lng(),c.lat(),d.lng(),d.lat())}return b},getMapObjectBoundsFromOLBounds:function(a){var b=null;if(a!=null){var c=new GLatLng(a.bottom,a.left),d=new GLatLng(a.top,a.right);b=new GLatLngBounds(c,d)}return b},addContainerPxFunction:function(){typeof GMap2!="undefined"&&!GMap2.fromLatLngToContainerPixel&&(GMap2.prototype.fromLatLngToContainerPixel=function(a){var b=this.fromLatLngToDivPixel(a),c=this.b.firstChild.firstChild;return b.x+=c.offsetLeft,b.y+=c.offsetTop,b})},getWarningHTML:function(){var a="";return a+="The Google Layer was unable to load correctly.<br>",a+="<br>",a+="To get rid of this message, select a new BaseLayer ",a+="in the layer switcher in the upper-right corner.<br>",a+="<br>",a+="Most likely, this is because the Google Maps library",a+=" script was either not included, or does not contain the",a+=" correct API key for your site.<br>",a+="<br>",a+="Developers: For help getting this working correctly, ",a+="<a href='http://trac.openlayers.org/wiki/Google' ",a+="target='_blank'>",a+="click here",a+="</a>",a},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getLongitudeFromMapObjectLonLat:function(a){return a.lng()},getLatitudeFromMapObjectLonLat:function(a){return a.lat()},getMapObjectLonLatFromLonLat:function(a,b){return new GLatLng(b,a)},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.Google"}),OpenLayers.Layer.Grid=OpenLayers.Class.create(),OpenLayers.Layer.Grid.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.HTTPRequest,{tileSize:null,grid:null,buffer:2,initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=new Array},destroy:function(){this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.options)),a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]),this.tileSize!=null&&(a.tileSize=this.tileSize.clone()),a.grid=new Array,a},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.apply(this,arguments),this.tileSize==null&&(this.tileSize=this.map.getTileSize())},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),a==null&&(a=this.map.getExtent());if(a!=null)if(!this.grid.length||b||!this.getGridBounds().containsBounds(a,!0))this._initTiles();else for(;;){var d=this.grid[0][0].position,e=this.map.getViewPortPxFromLayerPx(d);if(e.x>-this.tileSize.w*(this.buffer-1))this.shiftColumn(!0);else if(e.x<-this.tileSize.w*this.buffer)this.shiftColumn(!1);else if(e.y>-this.tileSize.h*(this.buffer-1))this.shiftRow(!0);else{if(!(e.y<-this.tileSize.h*this.buffer))break;this.shiftRow(!1)}}},getGridBounds:function(){var a=this.grid.length-1,b=this.grid[a][0],c=this.grid[0].length-1,d=this.grid[0][c];return new OpenLayers.Bounds(b.bounds.left,b.bounds.bottom,d.bounds.right,d.bounds.top)},_initTiles:function(){var a=this.map.getSize(),b=this.map.getExtent(),c=this.map.getMaxExtent(),d=this.map.getResolution(),e=d*this.tileSize.w,f=d*this.tileSize.h,g=b.left-c.left,h=Math.floor(g/e)-this.buffer,i=g/e-h,j=-i*this.tileSize.w,k=c.left+h*e,l=b.top-(c.bottom+f),m=Math.ceil(l/f)+this.buffer,n=m-l/f,o=-n*this.tileSize.h,p=c.bottom+m*f;j=Math.round(j),o=Math.round(o),this.origin=new OpenLayers.Pixel(j,o);var q=j,r=k,s=0;do{var t=this.grid[s++];t||(t=new Array,this.grid.push(t)),k=r,j=q;var u=0;do{var v=new OpenLayers.Bounds(k,p,k+e,p+f),w=j;w-=parseInt(this.map.layerContainerDiv.style.left);var x=o;x-=parseInt(this.map.layerContainerDiv.style.top);var y=new OpenLayers.Pixel(w,x),z=t[u++];z?z.moveTo(v,y,!1):(z=this.addTile(v,y),t.push(z)),k+=e,j+=this.tileSize.w}while(k<=b.right+e*this.buffer);p-=f,o+=this.tileSize.h}while(p>=b.bottom-f*this.buffer);this.spiralTileLoad()},spiralTileLoad:function(){var a=new Array,b=["right","down","left","up"],c=0,d=-1,e=OpenLayers.Util.indexOf(b,"right"),f=0;while(f<b.length){var g=c,h=d;switch(b[e]){case"right":h++;break;case"down":g++;break;case"left":h--;break;case"up":g--}var i=null;g<this.grid.length&&g>=0&&h<this.grid[0].length&&h>=0&&(i=this.grid[g][h]),i!=null&&!i.queued?(a.unshift(i),i.queued=!0,f=0,c=g,d=h):(e=(e+1)%4,f++)}for(var j=0;j<a.length;j++){var i=a[j];i.draw(),i.queued=!1}},addTile:function(a,b){},clearGrid:function(){if(this.grid)for(var a=0;a<this.grid.length;a++){var b=this.grid[a];for(var c=0;c<b.length;c++)OpenLayers.Util.clearArray(b[c])}},shiftRow:function(a){var b=a?0:this.grid.length-1,c=this.grid[b],d=this.map.getResolution(),e=a?-this.tileSize.h:this.tileSize.h,f=d*-e,g=a?this.grid.pop():this.grid.shift();for(var h=0;h<c.length;h++){var i=c[h],j=i.bounds.clone(),k=i.position.clone();j.bottom=j.bottom+f,j.top=j.top+f,k.y=k.y+e,g[h].moveTo(j,k)}a?this.grid.unshift(g):this.grid.push(g)},shiftColumn:function(a){var b=a?-this.tileSize.w:this.tileSize.w,c=this.map.getResolution(),d=c*b;for(var e=0;e<this.grid.length;e++){var f=this.grid[e],g=a?0:f.length-1,h=f[g],i=h.bounds.clone(),j=h.position.clone();i.left=i.left+d,i.right=i.right+d,j.x=j.x+b;var k=a?this.grid[e].pop():this.grid[e].shift();k.moveTo(i,j),a?this.grid[e].unshift(k):this.grid[e].push(k)}},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Layer.MultiMap=OpenLayers.Class.create(),OpenLayers.Layer.MultiMap.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[9,1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20],type:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments)},loadMapObject:function(){try{this.mapObject=new MultimapViewer(this.div)}catch(a){}},getWarningHTML:function(){var a="";return a+="The MM Layer was unable to load correctly.<br>",a+="<br>",a+="To get rid of this message, select a new BaseLayer ",a+="in the layer switcher in the upper-right corner.<br>",a+="<br>",a+="Most likely, this is because the MM library",a+=" script was either not correctly included.<br>",a+="<br>",a+="Demmlopers: For help getting this working correctly, ",a+="<a href='http://trac.openlayers.org/wiki/MultiMap' ",a+="target='_blank'>",a+="click here",a+="</a>",a},setMapObjectCenter:function(a,b){this.mapObject.goToPosition(a,b)},getMapObjectCenter:function(){return this.mapObject.getCurrentPosition()},getMapObjectZoom:function(){return this.mapObject.getZoomFactor()},getMapObjectLonLatFromMapObjectPixel:function(a){return a.x=a.x-this.map.getSize().w/2,a.y=a.y-this.map.getSize().h/2,this.mapObject.getMapPositionAt(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.geoPosToContainerPixels(a)},getLongitudeFromMapObjectLonLat:function(a){return a.lon},getLatitudeFromMapObjectLonLat:function(a){return a.lat},getMapObjectLonLatFromLonLat:function(a,b){return new MMLatLon(b,a)},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new MMPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.MultiMap"}),OpenLayers.Layer.Text=OpenLayers.Class.create(),OpenLayers.Layer.Text.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Markers,{location:null,features:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments),this.features=new Array,this.location!=null&&OpenLayers.loadURL(this.location,null,this,this.parseData)},destroy:function(){this.clearFeatures(),this.features=null,OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments)},parseData:function(a){var b=a.responseText,c=b.split("\n"),d;for(var e=0;e<c.length-1;e++){var f=c[e].replace(/^\s*/,"").replace(/\s*$/,"");if(f.charAt(0)!="#")if(!d)d=f.split("\t");else{var g=f.split("\t"),h=new OpenLayers.LonLat(0,0),i,j,k,l,m,n=!1;for(var o=0;o<g.length;o++)if(g[o])if(d[o]=="point"){var p=g[o].split(",");h.lat=parseFloat(p[0]),h.lon=parseFloat(p[1]),n=!0}else if(d[o]=="lat")h.lat=parseFloat(g[o]),n=!0;else if(d[o]=="lon")h.lon=parseFloat(g[o]),n=!0;else if(d[o]=="title")i=g[o];else if(d[o]=="image"||d[o]=="icon")j=g[o];else if(d[o]=="iconSize"){var q=g[o].split(",");l=new OpenLayers.Size(parseFloat(q[0]),parseFloat(q[1]))}else if(d[o]=="iconOffset"){var r=g[o].split(",");m=new OpenLayers.Pixel(parseFloat(r[0]),parseFloat(r[1]))}else d[o]=="title"?i=g[o]:d[o]=="description"&&(description=g[o]);if(n){var s=new Object;j!=null?s.icon=new OpenLayers.Icon(j,l,m):(s.icon=OpenLayers.Marker.defaultIcon(),l!=null&&s.icon.setSize(l)),i!=null&&description!=null&&(s.popupContentHTML="<h2>"+i+"</h2><p>"+description+"</p>");var t=new OpenLayers.Feature(this,h,s);this.features.push(t);var u=t.createMarker();u.events.register("click",t,this.markerClick),this.addMarker(u)}}}},markerClick:function(a){sameMarkerClicked=this==this.layer.selectedFeature,this.layer.selectedFeature=sameMarkerClicked?null:this;for(var b=0;b<this.layer.map.popups.length;b++)this.layer.map.removePopup(this.layer.map.popups[b]);sameMarkerClicked||this.layer.map.addPopup(this.createPopup()),OpenLayers.Event.stop(a)},clearFeatures:function(){if(this.features!=null)while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a),a.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"}),OpenLayers.Layer.VirtualEarth=OpenLayers.Class.create(),OpenLayers.Layer.VirtualEarth.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20],type:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments)},loadMapObject:function(){var a=OpenLayers.Util.createDiv(this.name),b=this.map.getSize();a.style.width=b.w,a.style.height=b.h,this.div.appendChild(a);try{this.mapObject=new VEMap(this.name)}catch(c){}if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type)}catch(c){}this.mapObject.HideDashboard()}},getWarningHTML:function(){var a="";return a+="The VE Layer was unable to load correctly.<br>",a+="<br>",a+="To get rid of this message, select a new BaseLayer ",a+="in the layer switcher in the upper-right corner.<br>",a+="<br>",a+="Most likely, this is because the VE library",a+=" script was either not correctly included.<br>",a+="<br>",a+="Developers: For help getting this working correctly, ",a+="<a href='http://trac.openlayers.org/wiki/VirtualEarth' ",a+="target='_blank'>",a+="click here",a+="</a>",a},setMapObjectCenter:function(a,b){this.mapObject.SetCenterAndZoom(a,b)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.PixelToLatLong(a.x,a.y)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.LatLongToPixel(a)},getLongitudeFromMapObjectLonLat:function(a){return a.Longitude},getLatitudeFromMapObjectLonLat:function(a){return a.Latitude},getMapObjectLonLatFromLonLat:function(a,b){return new VELatLong(b,a)},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new Msn.VE.Pixel(a,b)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"}),OpenLayers.Layer.Yahoo=OpenLayers.Class.create(),OpenLayers.Layer.Yahoo.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:15,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19
,4291534423828125e-20],type:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments)},loadMapObject:function(){try{this.mapObject=new YMap(this.div,this.type)}catch(a){}},setMap:function(a){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var a=$("ygddfdiv");a!=null&&(a.parentNode!=null&&a.parentNode.removeChild(a),this.map.events.unregister("moveend",this,this.fixYahooEventPane))},getWarningHTML:function(){var a="";return a+="The Yahoo Layer was unable to load correctly.<br>",a+="<br>",a+="To get rid of this message, select a new BaseLayer ",a+="in the layer switcher in the upper-right corner.<br>",a+="<br>",a+="Most likely, this is because the Yahoo library",a+=" script was either not correctly included.<br>",a+="<br>",a+="Developers: For help getting this working correctly, ",a+="<a href='http://trac.openlayers.org/wiki/Yahoo' ",a+="target='_blank'>",a+="click here",a+="</a>",a},getOLZoomFromMapObjectZoom:function(a){var b=null;return a!=null&&(b=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[a]),b=18-b),b},getMapObjectZoomFromOLZoom:function(a){var b=null;return a!=null&&(b=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[a]),b=18-b),b},setMapObjectCenter:function(a,b){this.mapObject.drawZoomAndCenter(a,b)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.convertXYLatLon(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.convertLatLonXY(a)},getLongitudeFromMapObjectLonLat:function(a){return a.Lon},getLatitudeFromMapObjectLonLat:function(a){return a.Lat},getMapObjectLonLatFromLonLat:function(a,b){return new YGeoPoint(b,a)},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new YCoordPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.Yahoo"}),OpenLayers.Popup.AnchoredBubble=OpenLayers.Class.create(),OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5,OpenLayers.Popup.AnchoredBubble.prototype=OpenLayers.Class.inherit(OpenLayers.Popup.Anchored,{rounded:!1,initialize:function(a,b,c,d,e,f){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(a){return OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments),this.setContentHTML(),this.setRicoCorners(!this.rounded),this.rounded=!0,this.setBackgroundColor(),this.setOpacity(),this.div},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);if(this.contentDiv!=null){var b=this.size.clone();b.h-=2*OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,b.h-=2*this.padding,this.contentDiv.style.height=b.h+"px",this.setRicoCorners(!this.rounded),this.rounded=!0}},setBackgroundColor:function(a){a!=undefined&&(this.backgroundColor=a),this.div!=null&&this.contentDiv!=null&&(this.div.style.background="transparent",Rico.Corner.changeColor(this.contentDiv,this.backgroundColor))},setOpacity:function(a){a!=undefined&&(this.opacity=a),this.div!=null&&this.contentDiv!=null&&Rico.Corner.changeOpacity(this.contentDiv,this.opacity)},setBorder:function(a){this.border=0},setRicoCorners:function(a){var b=this.getCornersToRound(this.relativePosition),c={corners:b,color:this.backgroundColor,bgColor:"transparent",blend:!1};a?Rico.Corner.round(this.div,c):(Rico.Corner.reRound(this.contentDiv,c),this.setBackgroundColor(),this.setOpacity())},getCornersToRound:function(){var a=["tl","tr","bl","br"],b=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);return OpenLayers.Util.removeItem(a,b),a.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"}),OpenLayers.Layer.KaMap=OpenLayers.Class.create(),OpenLayers.Layer.KaMap.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Grid,{isBaseLayer:!0,units:null,resolution:OpenLayers.DOTS_PER_INCH,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(a,b,c,d){var e=new Array;e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),this.params=c?c:{},c&&OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(a){var b=this.map.getResolution(),c=Math.round(this.map.getScale()*1e4)/1e4,d=new OpenLayers.Size(b*this.tileSize.w,b*this.tileSize.h),e=Math.round(a.left/d.w*this.tileSize.w),f=-Math.round(a.top/d.h*this.tileSize.h);return this.getFullRequestString({t:f,l:e,s:c})},addTile:function(a,b){var c=this.getURL(a);return new OpenLayers.Tile.Image(this,b,a,c,this.tileSize)},_initTiles:function(){var a=this.map.getSize(),b=this.map.getExtent(),c=this.map.getMaxExtent(),d=this.map.getResolution(),e=d*this.tileSize.w,f=d*this.tileSize.h,g=b.left,h=Math.floor(g/e),i=g/e-h,j=-i*this.tileSize.w,k=h*e,l=b.top,m=Math.ceil(l/f),n=m-l/f,o=-(n+1)*this.tileSize.h,p=m*f;j=Math.round(j),o=Math.round(o),this.origin=new OpenLayers.Pixel(j,o);var q=j,r=k,s=0;do{var t;t=this.grid[s++],t||(t=new Array,this.grid.push(t)),k=r,j=q;var u=0;do{var v=new OpenLayers.Bounds(k,p,k+e,p+f),w=j;w-=parseInt(this.map.layerContainerDiv.style.left);var x=o;x-=parseInt(this.map.layerContainerDiv.style.top);var y=new OpenLayers.Pixel(w,x),z;z=t[u++],z?z.moveTo(v,y,!1):(z=this.addTile(v,y),t.push(z)),k+=e,j+=this.tileSize.w}while(k<=b.right+e*this.buffer);p-=f,o+=this.tileSize.h}while(p>=b.bottom-f*this.buffer);this.spiralTileLoad()},CLASS_NAME:"OpenLayers.Layer.KaMap"}),OpenLayers.Layer.MapServer=OpenLayers.Class.create(),OpenLayers.Layer.MapServer.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(a,b,c){var d=new Array;c=OpenLayers.Util.upperCaseObject(c),d.push(a,b,c),OpenLayers.Layer.Grid.prototype.initialize.apply(this,d),arguments.length>0&&OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS))},isBaseLayer:function(){return this.params.TRANSPARENT!="true"},clone:function(a,b){var c={};OpenLayers.Util.extend(c,this.params),OpenLayers.Util.extend(c,b);var d=new OpenLayers.Layer.MapServer(a,this.url,c);return d.setTileSize(this.tileSize),d},addTile:function(a,b){var c=this.getURL(a);return new OpenLayers.Tile.Image(this,b,a,c,this.tileSize)},getURL:function(a){var b=this.getFullRequestString({mapext:a.toBBOX().replace(/,/g,"+"),imgext:a.toBBOX().replace(/,/g,"+"),map_size:this.tileSize.w+"+"+this.tileSize.h,imgx:this.tileSize.w/2,imgy:this.tileSize.h/2,imgxy:this.tileSize.w+"+"+this.tileSize.h});return b},CLASS_NAME:"OpenLayers.Layer.MapServer"}),OpenLayers.Layer.WFS=OpenLayers.Class.create(),OpenLayers.Layer.WFS.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Grid,OpenLayers.Layer.Markers,{isBaseLayer:!1,buffer:1,featureClass:OpenLayers.Feature.WFS,tileClass:OpenLayers.Tile.WFS,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature",typename:"docpoint"},initialize:function(a,b,c,d){var e=new Array;c=OpenLayers.Util.upperCaseObject(c),e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);var e=new Array;e.push(a,d),OpenLayers.Layer.Markers.prototype.initialize.apply(this,e),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS))},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments),OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments),OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.options)),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]),a},addTile:function(a,b){var c=new Array;c.push(this.getFullRequestString());if(this.urls!=null)for(var d=0;d<this.urls.length;d++)c.push(this.getFullRequestString(null,this.urls[d]));return new this.tileClass(this,b,a,c,this.tileSize)},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,c),this.grid!=null&&this._initTiles()},getFullRequestString:function(a){var b=this.map.getProjection();return this.params.SRS=b=="none"?null:b,OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},getFeature:function(a){var b=null;if(a!=null&&this.grid)for(var c=0;c<this.grid.length;c++){var d=this.grid[c];for(var e=0;e<d.length;e++){var f=d[e];for(var g=0;g<f.features.length;g++){var h=f.features[g];h.id==a&&(b=h)}}}return b},CLASS_NAME:"OpenLayers.Layer.WFS"}),OpenLayers.Layer.WMS=OpenLayers.Class.create(),OpenLayers.Layer.WMS.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},reproject:!0,initialize:function(a,b,c,d){var e=new Array;c=OpenLayers.Util.upperCaseObject(c),e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(d==null||d.isBaseLayer==null)this.isBaseLayer=this.params.TRANSPARENT!="true"&&this.params.TRANSPARENT!=1},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.options)),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]),a},getURL:function(a){return this.getFullRequestString({BBOX:a.toBBOX(),WIDTH:this.tileSize.w,HEIGHT:this.tileSize.h})},addTile:function(a,b){return url=this.getURL(a),new OpenLayers.Tile.Image(this,b,a,url,this.tileSize)},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,c),this.map!=null&&this._initTiles()},getFullRequestString:function(a){var b=this.map.getProjection();return this.params.SRS=b=="none"?null:b,OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.Layer.WorldWind=OpenLayers.Class.create(),OpenLayers.Layer.WorldWind.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(a,b,c,d,e,f){this.lzd=c,this.zoomLevels=d;var g=new Array;g.push(a,b,e,f),OpenLayers.Layer.Grid.prototype.initialize.apply(this,g),this.params=e?e:{},e&&OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},addTile:function(a,b){if(this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels){var c=this.getURL(a);return new OpenLayers.Tile.Image(this,b,a,c,this.tileSize)}return new OpenLayers.Tile.Image(this,b,a,OpenLayers.Util.getImagesLocation()+"blank.gif",this.tileSize)},getZoom:function(){var a=this.map.getZoom(),b=this.map.getMaxExtent();return a-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2),a},getURL:function(a){var b=this.getZoom(),c=this.map.getMaxExtent(),d=this.lzd/Math.pow(2,this.getZoom()),e=Math.floor((a.left-c.left)/d),f=Math.floor((a.bottom-c.bottom)/d);return this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels?this.getFullRequestString({L:b,X:e,Y:f}):OpenLayers.Util.getImagesLocation()+"blank.gif"},CLASS_NAME:"OpenLayers.Layer.WorldWind"}),OpenLayers.Layer.WMS.Untiled=OpenLayers.Class.create(),OpenLayers.Layer.WMS.Untiled.prototype=OpenLayers.Class.inherit(OpenLayers.Layer.HTTPRequest,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},reproject:!0,ratio:2,tile:null,initialize:function(a,b,c,d){var e=new Array;c=OpenLayers.Util.upperCaseObject(c),e.push(a,b,c,d),OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,e),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(d==null||d.isBaseLayer==null)this.isBaseLayer=this.params.TRANSPARENT!="true"&&this.params.TRANSPARENT!=1},destroy:function(){this.tile.destroy(),this.tile=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clone:function(a){return a==null&&(a=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.options)),a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]),a},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),a==null&&(a=this.map.getExtent());var d=this.tile==null,e=!d&&!this.tile.bounds.containsBounds(a);if(b||d||!c&&e){this.tile&&this.tile.clear();var f=a.getCenterLonLat(),g=a.getWidth()*this.ratio,h=a.getHeight()*this.ratio,i=new OpenLayers.Bounds(f.lon-g/2,f.lat-h/2,f.lon+g/2,f.lat+h/2),j=this.map.getSize();j.w=j.w*this.ratio,j.h=j.h*this.ratio;var k=this.getURL(i),l=new OpenLayers.LonLat(i.left,i.top),m=this.map.getLayerPxFromLonLat(l);this.tile&&!this.tile.size.equals(j)&&(this.tile.destroy(),this.tile=null),this.tile?this.tile.moveTo(i,m):(this.tile=new OpenLayers.Tile.Image(this,m,i,k,j),this.tile.draw())}},getURL:function(a){var b=this.map.getSize();return b.w=b.w*this.ratio,b.h=b.h*this.ratio,this.getFullRequestString({BBOX:a.toBBOX(),WIDTH:b.w,HEIGHT:b.h})},setUrl:function(a){OpenLayers.Layer.HTTPRequest.prototype.setUrl.apply(this,arguments),this.moveTo()},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,c),this.moveTo()},getFullRequestString:function(a){var b=this.map.getProjection();return this.params.SRS=b=="none"?null:b,OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"});